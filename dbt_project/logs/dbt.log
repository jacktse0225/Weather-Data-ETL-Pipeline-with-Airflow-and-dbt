[0m15:49:57.873122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440e90a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440e908110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440e90b0d0>]}


============================== 15:49:57.878614 | 52e259b5-ef5e-42ef-8c05-3fe2ea12f1f1 ==============================
[0m15:49:57.878614 [info ] [MainThread]: Running with dbt=1.7.16
[0m15:49:57.879521 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root', 'log_path': '/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:49:58.002241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52e259b5-ef5e-42ef-8c05-3fe2ea12f1f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440d1f72d0>]}
[0m15:49:58.052496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52e259b5-ef5e-42ef-8c05-3fe2ea12f1f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440e90ac10>]}
[0m15:49:58.053730 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m15:49:58.060981 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m15:49:58.063166 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:49:58.063784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '52e259b5-ef5e-42ef-8c05-3fe2ea12f1f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440e91ce50>]}
[0m15:49:59.443106 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models/example/schema.yml'
[0m15:49:59.445768 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models/example/schema.yml'
[0m15:49:59.719891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52e259b5-ef5e-42ef-8c05-3fe2ea12f1f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440d110310>]}
[0m15:49:59.753166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52e259b5-ef5e-42ef-8c05-3fe2ea12f1f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440cf8a4d0>]}
[0m15:49:59.754396 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m15:49:59.755360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52e259b5-ef5e-42ef-8c05-3fe2ea12f1f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4411ae1890>]}
[0m15:49:59.757895 [info ] [MainThread]: 
[0m15:49:59.759628 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:49:59.761632 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydatabase'
[0m15:49:59.779991 [debug] [ThreadPool]: Using postgres connection "list_mydatabase"
[0m15:49:59.781030 [debug] [ThreadPool]: On list_mydatabase: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase"} */

    select distinct nspname from pg_namespace
  
[0m15:49:59.781866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:01.822609 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "192.168.2.1", port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m15:50:03.857532 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase"} */

    select distinct nspname from pg_namespace
  
[0m15:50:03.858453 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m15:50:03.859267 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m15:50:03.859895 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m15:50:03.860519 [debug] [ThreadPool]: On list_mydatabase: No close available on handle
[0m15:50:03.862080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:03.862650 [debug] [MainThread]: Connection 'list_mydatabase' was properly closed.
[0m15:50:03.863275 [info ] [MainThread]: 
[0m15:50:03.864023 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 4.10 seconds (4.10s).
[0m15:50:03.864911 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "192.168.2.1", port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m15:50:03.866146 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.0466413, "process_user_time": 3.56593, "process_kernel_time": 0.299657, "process_mem_max_rss": "111268", "process_out_blocks": "1216", "command_success": false, "process_in_blocks": "0"}
[0m15:50:03.866956 [debug] [MainThread]: Command `dbt run` failed at 15:50:03.866842 after 6.05 seconds
[0m15:50:03.867630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440e938610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44128e05d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44075618d0>]}
[0m15:50:03.868300 [debug] [MainThread]: Flushing usage events
[0m15:53:49.269942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc6d94d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc73dbdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc6d8e7d0>]}


============================== 15:53:49.274925 | b8ef13b9-6063-44b9-a6e8-680008169a69 ==============================
[0m15:53:49.274925 [info ] [MainThread]: Running with dbt=1.7.16
[0m15:53:49.275839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root', 'log_path': '/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m15:53:49.392085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8ef13b9-6063-44b9-a6e8-680008169a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc6bd9f50>]}
[0m15:53:49.442130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8ef13b9-6063-44b9-a6e8-680008169a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc5561550>]}
[0m15:53:49.443065 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m15:53:49.450210 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m15:53:49.529562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:53:49.530352 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/example/schema.yml
[0m15:53:49.585680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8ef13b9-6063-44b9-a6e8-680008169a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc538be10>]}
[0m15:53:49.602085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8ef13b9-6063-44b9-a6e8-680008169a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc555e050>]}
[0m15:53:49.602739 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m15:53:49.603401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8ef13b9-6063-44b9-a6e8-680008169a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc9b698d0>]}
[0m15:53:49.605221 [info ] [MainThread]: 
[0m15:53:49.606407 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:53:49.607757 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydatabase'
[0m15:53:49.617863 [debug] [ThreadPool]: Using postgres connection "list_mydatabase"
[0m15:53:49.618439 [debug] [ThreadPool]: On list_mydatabase: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase"} */

    select distinct nspname from pg_namespace
  
[0m15:53:49.619099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:51.637078 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "192.168.2.1", port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m15:53:53.663714 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase"} */

    select distinct nspname from pg_namespace
  
[0m15:53:53.664452 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m15:53:53.665128 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m15:53:53.665697 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m15:53:53.666264 [debug] [ThreadPool]: On list_mydatabase: No close available on handle
[0m15:53:53.667668 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:53:53.668176 [debug] [MainThread]: Connection 'list_mydatabase' was properly closed.
[0m15:53:53.668695 [info ] [MainThread]: 
[0m15:53:53.669613 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 4.06 seconds (4.06s).
[0m15:53:53.670400 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "192.168.2.1", port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m15:53:53.671521 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.444744, "process_user_time": 1.843073, "process_kernel_time": 0.171214, "process_mem_max_rss": "106580", "process_out_blocks": "1216", "command_success": false, "process_in_blocks": "0"}
[0m15:53:53.672249 [debug] [MainThread]: Command `dbt run` failed at 15:53:53.672142 after 4.45 seconds
[0m15:53:53.672875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc6d79010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc6d7a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc6d79150>]}
[0m15:53:53.673466 [debug] [MainThread]: Flushing usage events
[0m16:00:14.635636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f583808ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58380d6ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f583808ed50>]}


============================== 16:00:14.640493 | b33855a2-4156-4881-b9d7-8ee1211eacff ==============================
[0m16:00:14.640493 [info ] [MainThread]: Running with dbt=1.7.16
[0m16:00:14.641422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m16:00:14.756550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b33855a2-4156-4881-b9d7-8ee1211eacff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5836960e50>]}
[0m16:00:14.805438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b33855a2-4156-4881-b9d7-8ee1211eacff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58380eb9d0>]}
[0m16:00:14.806251 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m16:00:14.813408 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m16:00:14.827216 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:00:14.828011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b33855a2-4156-4881-b9d7-8ee1211eacff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58367a3510>]}
[0m16:00:15.723431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b33855a2-4156-4881-b9d7-8ee1211eacff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5836877e90>]}
[0m16:00:15.739685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b33855a2-4156-4881-b9d7-8ee1211eacff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f583672e790>]}
[0m16:00:15.740346 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:00:15.741142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b33855a2-4156-4881-b9d7-8ee1211eacff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5836655790>]}
[0m16:00:15.742900 [info ] [MainThread]: 
[0m16:00:15.743991 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:00:15.745280 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydatabase'
[0m16:00:15.754966 [debug] [ThreadPool]: Using postgres connection "list_mydatabase"
[0m16:00:15.755545 [debug] [ThreadPool]: On list_mydatabase: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase"} */

    select distinct nspname from pg_namespace
  
[0m16:00:15.756125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:15.768772 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:00:15.770236 [debug] [ThreadPool]: On list_mydatabase: Close
[0m16:00:15.771672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydatabase, now create_mydatabase_default)
[0m16:00:15.772623 [debug] [ThreadPool]: Creating schema "database: "mydatabase"
schema: "default"
"
[0m16:00:15.777609 [debug] [ThreadPool]: Using postgres connection "create_mydatabase_default"
[0m16:00:15.778170 [debug] [ThreadPool]: On create_mydatabase_default: BEGIN
[0m16:00:15.778721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:15.786637 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:00:15.787226 [debug] [ThreadPool]: Using postgres connection "create_mydatabase_default"
[0m16:00:15.787812 [debug] [ThreadPool]: On create_mydatabase_default: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_mydatabase_default"} */
create schema if not exists "default"
[0m16:00:15.793069 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m16:00:15.794252 [debug] [ThreadPool]: On create_mydatabase_default: COMMIT
[0m16:00:15.794829 [debug] [ThreadPool]: Using postgres connection "create_mydatabase_default"
[0m16:00:15.795375 [debug] [ThreadPool]: On create_mydatabase_default: COMMIT
[0m16:00:15.797199 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m16:00:15.797825 [debug] [ThreadPool]: On create_mydatabase_default: Close
[0m16:00:15.799783 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_mydatabase_default, now list_mydatabase_default)
[0m16:00:15.805377 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_default"
[0m16:00:15.805932 [debug] [ThreadPool]: On list_mydatabase_default: BEGIN
[0m16:00:15.806467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:15.816002 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:00:15.816609 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_default"
[0m16:00:15.817167 [debug] [ThreadPool]: On list_mydatabase_default: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase_default"} */
select
      'mydatabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'default'
    union all
    select
      'mydatabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'default'
    union all
    select
      'mydatabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'default'
  
[0m16:00:15.831507 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:00:15.832927 [debug] [ThreadPool]: On list_mydatabase_default: ROLLBACK
[0m16:00:15.834247 [debug] [ThreadPool]: On list_mydatabase_default: Close
[0m16:00:15.838869 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:15.839498 [debug] [MainThread]: On master: BEGIN
[0m16:00:15.840083 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:00:15.848274 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:00:15.848909 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:15.849497 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:00:15.859869 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:00:15.861205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b33855a2-4156-4881-b9d7-8ee1211eacff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5834d3cb50>]}
[0m16:00:15.861868 [debug] [MainThread]: On master: ROLLBACK
[0m16:00:15.863200 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:15.863784 [debug] [MainThread]: On master: BEGIN
[0m16:00:15.865825 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:00:15.866398 [debug] [MainThread]: On master: COMMIT
[0m16:00:15.866947 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:15.867503 [debug] [MainThread]: On master: COMMIT
[0m16:00:15.868753 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:00:15.869291 [debug] [MainThread]: On master: Close
[0m16:00:15.870229 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:00:15.870892 [info ] [MainThread]: 
[0m16:00:15.877546 [debug] [Thread-1 (]: Began running node model.dbt_project.test
[0m16:00:15.878399 [info ] [Thread-1 (]: 1 of 1 START sql table model default.test ...................................... [RUN]
[0m16:00:15.879467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydatabase_default, now model.dbt_project.test)
[0m16:00:15.880057 [debug] [Thread-1 (]: Began compiling node model.dbt_project.test
[0m16:00:15.887178 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.test"
[0m16:00:15.896523 [debug] [Thread-1 (]: Timing info for model.dbt_project.test (compile): 16:00:15.880521 => 16:00:15.896319
[0m16:00:15.897111 [debug] [Thread-1 (]: Began executing node model.dbt_project.test
[0m16:00:15.931819 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.test"
[0m16:00:15.941046 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.test"
[0m16:00:15.941652 [debug] [Thread-1 (]: On model.dbt_project.test: BEGIN
[0m16:00:15.942217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:15.950805 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:00:15.951438 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.test"
[0m16:00:15.952013 [debug] [Thread-1 (]: On model.dbt_project.test: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.test"} */

  
    

  create  table "mydatabase"."default"."test__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "mydatabase"."mydatabase"."weather_data"
  );
  
[0m16:00:15.954006 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "mydatabase.weather_data" does not exist
LINE 12:     SELECT * FROM "mydatabase"."mydatabase"."weather_data"
                           ^

[0m16:00:15.954699 [debug] [Thread-1 (]: On model.dbt_project.test: ROLLBACK
[0m16:00:15.956144 [debug] [Thread-1 (]: Timing info for model.dbt_project.test (execute): 16:00:15.897618 => 16:00:15.955943
[0m16:00:15.956733 [debug] [Thread-1 (]: On model.dbt_project.test: Close
[0m16:00:15.960420 [debug] [Thread-1 (]: Database Error in model test (models/example/test.sql)
  relation "mydatabase.weather_data" does not exist
  LINE 12:     SELECT * FROM "mydatabase"."mydatabase"."weather_data"
                             ^
  compiled Code at target/run/dbt_project/models/example/test.sql
[0m16:00:15.961103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b33855a2-4156-4881-b9d7-8ee1211eacff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5834e2dd50>]}
[0m16:00:15.961939 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model default.test ............................. [[31mERROR[0m in 0.08s]
[0m16:00:15.962810 [debug] [Thread-1 (]: Finished running node model.dbt_project.test
[0m16:00:15.965070 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:15.965607 [debug] [MainThread]: On master: BEGIN
[0m16:00:15.966115 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:00:15.974176 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:00:15.974883 [debug] [MainThread]: On master: COMMIT
[0m16:00:15.975442 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:15.976095 [debug] [MainThread]: On master: COMMIT
[0m16:00:15.977308 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:00:15.977858 [debug] [MainThread]: On master: Close
[0m16:00:15.978748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:15.979246 [debug] [MainThread]: Connection 'model.dbt_project.test' was properly closed.
[0m16:00:15.979765 [info ] [MainThread]: 
[0m16:00:15.980400 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m16:00:15.981299 [debug] [MainThread]: Command end result
[0m16:00:15.996196 [info ] [MainThread]: 
[0m16:00:15.996970 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:00:15.997634 [info ] [MainThread]: 
[0m16:00:15.998235 [error] [MainThread]:   Database Error in model test (models/example/test.sql)
  relation "mydatabase.weather_data" does not exist
  LINE 12:     SELECT * FROM "mydatabase"."mydatabase"."weather_data"
                             ^
  compiled Code at target/run/dbt_project/models/example/test.sql
[0m16:00:15.998901 [info ] [MainThread]: 
[0m16:00:15.999564 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:00:16.000705 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4067795, "process_user_time": 2.678716, "process_kernel_time": 0.177922, "process_mem_max_rss": "114504", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m16:00:16.001447 [debug] [MainThread]: Command `dbt run` failed at 16:00:16.001335 after 1.41 seconds
[0m16:00:16.002082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f583c05c750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f583c05c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5838086650>]}
[0m16:00:16.002731 [debug] [MainThread]: Flushing usage events
[0m16:02:23.275880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa490f1b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa490d3dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa4a1fda50>]}


============================== 16:02:23.280765 | 8a19015d-1ebf-4363-a8b0-06954250684b ==============================
[0m16:02:23.280765 [info ] [MainThread]: Running with dbt=1.7.16
[0m16:02:23.281557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m16:02:23.396846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a19015d-1ebf-4363-a8b0-06954250684b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa48f26410>]}
[0m16:02:23.446423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a19015d-1ebf-4363-a8b0-06954250684b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa47807e50>]}
[0m16:02:23.447496 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m16:02:23.454811 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m16:02:23.529445 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:02:23.530133 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:02:23.535330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a19015d-1ebf-4363-a8b0-06954250684b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa47788090>]}
[0m16:02:23.551368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a19015d-1ebf-4363-a8b0-06954250684b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa477348d0>]}
[0m16:02:23.552024 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:02:23.552678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a19015d-1ebf-4363-a8b0-06954250684b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa47718d10>]}
[0m16:02:23.554264 [info ] [MainThread]: 
[0m16:02:23.555368 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:02:23.556663 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydatabase'
[0m16:02:23.566256 [debug] [ThreadPool]: Using postgres connection "list_mydatabase"
[0m16:02:23.566829 [debug] [ThreadPool]: On list_mydatabase: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase"} */

    select distinct nspname from pg_namespace
  
[0m16:02:23.567395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:23.577145 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m16:02:23.578552 [debug] [ThreadPool]: On list_mydatabase: Close
[0m16:02:23.580238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydatabase, now list_mydatabase_default)
[0m16:02:23.586308 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_default"
[0m16:02:23.586887 [debug] [ThreadPool]: On list_mydatabase_default: BEGIN
[0m16:02:23.587410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:02:23.595108 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:02:23.595651 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_default"
[0m16:02:23.596160 [debug] [ThreadPool]: On list_mydatabase_default: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase_default"} */
select
      'mydatabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'default'
    union all
    select
      'mydatabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'default'
    union all
    select
      'mydatabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'default'
  
[0m16:02:23.599112 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:02:23.600368 [debug] [ThreadPool]: On list_mydatabase_default: ROLLBACK
[0m16:02:23.601630 [debug] [ThreadPool]: On list_mydatabase_default: Close
[0m16:02:23.605825 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:23.606417 [debug] [MainThread]: On master: BEGIN
[0m16:02:23.606998 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:02:23.614718 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:02:23.615261 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:23.615834 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:02:23.619334 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:02:23.620806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a19015d-1ebf-4363-a8b0-06954250684b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa490f1690>]}
[0m16:02:23.621537 [debug] [MainThread]: On master: ROLLBACK
[0m16:02:23.622871 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:23.623504 [debug] [MainThread]: On master: BEGIN
[0m16:02:23.625504 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:02:23.626104 [debug] [MainThread]: On master: COMMIT
[0m16:02:23.626632 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:23.627150 [debug] [MainThread]: On master: COMMIT
[0m16:02:23.628440 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:02:23.628997 [debug] [MainThread]: On master: Close
[0m16:02:23.629865 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:02:23.630480 [info ] [MainThread]: 
[0m16:02:23.636620 [debug] [Thread-1 (]: Began running node model.dbt_project.test
[0m16:02:23.637334 [info ] [Thread-1 (]: 1 of 1 START sql table model default.test ...................................... [RUN]
[0m16:02:23.638285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydatabase_default, now model.dbt_project.test)
[0m16:02:23.638865 [debug] [Thread-1 (]: Began compiling node model.dbt_project.test
[0m16:02:23.645911 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.test"
[0m16:02:23.650237 [debug] [Thread-1 (]: Timing info for model.dbt_project.test (compile): 16:02:23.639326 => 16:02:23.650039
[0m16:02:23.650841 [debug] [Thread-1 (]: Began executing node model.dbt_project.test
[0m16:02:23.685751 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.test"
[0m16:02:23.690121 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.test"
[0m16:02:23.690689 [debug] [Thread-1 (]: On model.dbt_project.test: BEGIN
[0m16:02:23.691239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:23.705809 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:02:23.706465 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.test"
[0m16:02:23.707049 [debug] [Thread-1 (]: On model.dbt_project.test: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.test"} */

  
    

  create  table "mydatabase"."default"."test__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "mydatabase"."mydatabase"."weather_data"
  );
  
[0m16:02:23.708533 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "mydatabase.weather_data" does not exist
LINE 12:     SELECT * FROM "mydatabase"."mydatabase"."weather_data"
                           ^

[0m16:02:23.709116 [debug] [Thread-1 (]: On model.dbt_project.test: ROLLBACK
[0m16:02:23.710500 [debug] [Thread-1 (]: Timing info for model.dbt_project.test (execute): 16:02:23.651312 => 16:02:23.710301
[0m16:02:23.711074 [debug] [Thread-1 (]: On model.dbt_project.test: Close
[0m16:02:23.714454 [debug] [Thread-1 (]: Database Error in model test (models/example/test.sql)
  relation "mydatabase.weather_data" does not exist
  LINE 12:     SELECT * FROM "mydatabase"."mydatabase"."weather_data"
                             ^
  compiled Code at target/run/dbt_project/models/example/test.sql
[0m16:02:23.715124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a19015d-1ebf-4363-a8b0-06954250684b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa476be690>]}
[0m16:02:23.715935 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model default.test ............................. [[31mERROR[0m in 0.08s]
[0m16:02:23.716764 [debug] [Thread-1 (]: Finished running node model.dbt_project.test
[0m16:02:23.719163 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:23.719722 [debug] [MainThread]: On master: BEGIN
[0m16:02:23.720241 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:02:23.728269 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:02:23.728842 [debug] [MainThread]: On master: COMMIT
[0m16:02:23.729354 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:23.729854 [debug] [MainThread]: On master: COMMIT
[0m16:02:23.731072 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:02:23.731618 [debug] [MainThread]: On master: Close
[0m16:02:23.732479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:02:23.733004 [debug] [MainThread]: Connection 'model.dbt_project.test' was properly closed.
[0m16:02:23.733551 [info ] [MainThread]: 
[0m16:02:23.734197 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m16:02:23.735083 [debug] [MainThread]: Command end result
[0m16:02:23.747780 [info ] [MainThread]: 
[0m16:02:23.748431 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:02:23.749049 [info ] [MainThread]: 
[0m16:02:23.749716 [error] [MainThread]:   Database Error in model test (models/example/test.sql)
  relation "mydatabase.weather_data" does not exist
  LINE 12:     SELECT * FROM "mydatabase"."mydatabase"."weather_data"
                             ^
  compiled Code at target/run/dbt_project/models/example/test.sql
[0m16:02:23.750323 [info ] [MainThread]: 
[0m16:02:23.750936 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:02:23.751948 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.51818895, "process_user_time": 1.88248, "process_kernel_time": 0.128126, "process_mem_max_rss": "109840", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m16:02:23.752650 [debug] [MainThread]: Command `dbt run` failed at 16:02:23.752542 after 0.52 seconds
[0m16:02:23.753227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa48f291d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa490da510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa4cf1f610>]}
[0m16:02:23.753826 [debug] [MainThread]: Flushing usage events
[0m16:04:46.725349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47527c5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47531eba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4752cac110>]}


============================== 16:04:46.730148 | 9ed698d9-7c05-4fee-97ea-2b4677640aad ==============================
[0m16:04:46.730148 [info ] [MainThread]: Running with dbt=1.7.16
[0m16:04:46.731037 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m16:04:46.847032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ed698d9-7c05-4fee-97ea-2b4677640aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4752d22190>]}
[0m16:04:46.895902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ed698d9-7c05-4fee-97ea-2b4677640aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47527df3d0>]}
[0m16:04:46.896850 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m16:04:46.903804 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m16:04:46.981135 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:04:46.981992 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/example/test.sql
[0m16:04:47.143492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ed698d9-7c05-4fee-97ea-2b4677640aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4752800b90>]}
[0m16:04:47.159385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ed698d9-7c05-4fee-97ea-2b4677640aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4750eb9310>]}
[0m16:04:47.160126 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:04:47.160774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ed698d9-7c05-4fee-97ea-2b4677640aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f475598d890>]}
[0m16:04:47.162490 [info ] [MainThread]: 
[0m16:04:47.163563 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:04:47.164917 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydatabase'
[0m16:04:47.174435 [debug] [ThreadPool]: Using postgres connection "list_mydatabase"
[0m16:04:47.175025 [debug] [ThreadPool]: On list_mydatabase: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase"} */

    select distinct nspname from pg_namespace
  
[0m16:04:47.175599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:47.184776 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m16:04:47.186136 [debug] [ThreadPool]: On list_mydatabase: Close
[0m16:04:47.187850 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydatabase, now list_mydatabase_default)
[0m16:04:47.193613 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_default"
[0m16:04:47.194252 [debug] [ThreadPool]: On list_mydatabase_default: BEGIN
[0m16:04:47.194865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:47.202737 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:04:47.203364 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_default"
[0m16:04:47.203947 [debug] [ThreadPool]: On list_mydatabase_default: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase_default"} */
select
      'mydatabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'default'
    union all
    select
      'mydatabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'default'
    union all
    select
      'mydatabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'default'
  
[0m16:04:47.207090 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:04:47.208418 [debug] [ThreadPool]: On list_mydatabase_default: ROLLBACK
[0m16:04:47.209663 [debug] [ThreadPool]: On list_mydatabase_default: Close
[0m16:04:47.213845 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:47.214431 [debug] [MainThread]: On master: BEGIN
[0m16:04:47.214953 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:04:47.222709 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:04:47.223332 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:47.223999 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:04:47.229256 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:04:47.230714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ed698d9-7c05-4fee-97ea-2b4677640aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4750ec42d0>]}
[0m16:04:47.231373 [debug] [MainThread]: On master: ROLLBACK
[0m16:04:47.232683 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:47.233235 [debug] [MainThread]: On master: BEGIN
[0m16:04:47.235296 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:04:47.235859 [debug] [MainThread]: On master: COMMIT
[0m16:04:47.236414 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:47.236932 [debug] [MainThread]: On master: COMMIT
[0m16:04:47.238210 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:04:47.238809 [debug] [MainThread]: On master: Close
[0m16:04:47.239711 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:04:47.240387 [info ] [MainThread]: 
[0m16:04:47.246682 [debug] [Thread-1 (]: Began running node model.dbt_project.test
[0m16:04:47.247445 [info ] [Thread-1 (]: 1 of 1 START sql table model default.test ...................................... [RUN]
[0m16:04:47.248427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydatabase_default, now model.dbt_project.test)
[0m16:04:47.249006 [debug] [Thread-1 (]: Began compiling node model.dbt_project.test
[0m16:04:47.255969 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.test"
[0m16:04:47.260503 [debug] [Thread-1 (]: Timing info for model.dbt_project.test (compile): 16:04:47.249478 => 16:04:47.260295
[0m16:04:47.261116 [debug] [Thread-1 (]: Began executing node model.dbt_project.test
[0m16:04:47.296271 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.test"
[0m16:04:47.300717 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.test"
[0m16:04:47.301308 [debug] [Thread-1 (]: On model.dbt_project.test: BEGIN
[0m16:04:47.301868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:47.310384 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:04:47.311031 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.test"
[0m16:04:47.311611 [debug] [Thread-1 (]: On model.dbt_project.test: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.test"} */

  
    

  create  table "mydatabase"."default"."test__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM weather_data
  );
  
[0m16:04:47.321537 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.0 seconds
[0m16:04:47.327500 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.test"
[0m16:04:47.328213 [debug] [Thread-1 (]: On model.dbt_project.test: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.test"} */
alter table "mydatabase"."default"."test__dbt_tmp" rename to "test"
[0m16:04:47.330377 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:04:47.346790 [debug] [Thread-1 (]: On model.dbt_project.test: COMMIT
[0m16:04:47.347449 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.test"
[0m16:04:47.348055 [debug] [Thread-1 (]: On model.dbt_project.test: COMMIT
[0m16:04:47.350297 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:04:47.356030 [debug] [Thread-1 (]: Applying DROP to: "mydatabase"."default"."test__dbt_backup"
[0m16:04:47.360607 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.test"
[0m16:04:47.361224 [debug] [Thread-1 (]: On model.dbt_project.test: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.test"} */
drop table if exists "mydatabase"."default"."test__dbt_backup" cascade
[0m16:04:47.363793 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:04:47.365467 [debug] [Thread-1 (]: Timing info for model.dbt_project.test (execute): 16:04:47.261579 => 16:04:47.365286
[0m16:04:47.366092 [debug] [Thread-1 (]: On model.dbt_project.test: Close
[0m16:04:47.367141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed698d9-7c05-4fee-97ea-2b4677640aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4750e799d0>]}
[0m16:04:47.367969 [info ] [Thread-1 (]: 1 of 1 OK created sql table model default.test ................................. [[32mSELECT 9[0m in 0.12s]
[0m16:04:47.368841 [debug] [Thread-1 (]: Finished running node model.dbt_project.test
[0m16:04:47.370477 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:47.371056 [debug] [MainThread]: On master: BEGIN
[0m16:04:47.371587 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:04:47.379526 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:04:47.380120 [debug] [MainThread]: On master: COMMIT
[0m16:04:47.380682 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:47.381197 [debug] [MainThread]: On master: COMMIT
[0m16:04:47.382510 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:04:47.383067 [debug] [MainThread]: On master: Close
[0m16:04:47.384142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:47.384694 [debug] [MainThread]: Connection 'model.dbt_project.test' was properly closed.
[0m16:04:47.385291 [info ] [MainThread]: 
[0m16:04:47.385936 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m16:04:47.386895 [debug] [MainThread]: Command end result
[0m16:04:47.401267 [info ] [MainThread]: 
[0m16:04:47.402118 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:04:47.402841 [info ] [MainThread]: 
[0m16:04:47.403569 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:04:47.405074 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7221237, "process_user_time": 2.054262, "process_kernel_time": 0.138267, "process_mem_max_rss": "115364", "process_out_blocks": "1312", "process_in_blocks": "0"}
[0m16:04:47.406098 [debug] [MainThread]: Command `dbt run` succeeded at 16:04:47.405948 after 0.72 seconds
[0m16:04:47.406809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f475678c5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f475678c650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4756911010>]}
[0m16:04:47.407458 [debug] [MainThread]: Flushing usage events
[0m16:05:39.113646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9af280110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9af280890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9af282b90>]}


============================== 16:05:39.118966 | 30abf4c2-7c21-46f9-8ffd-5efb60b4fca2 ==============================
[0m16:05:39.118966 [info ] [MainThread]: Running with dbt=1.7.16
[0m16:05:39.119739 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:05:39.234829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30abf4c2-7c21-46f9-8ffd-5efb60b4fca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9af11df90>]}
[0m16:05:39.283955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30abf4c2-7c21-46f9-8ffd-5efb60b4fca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9ad9f6f90>]}
[0m16:05:39.284907 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m16:05:39.291823 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m16:05:39.365966 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:05:39.366583 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:05:39.371566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30abf4c2-7c21-46f9-8ffd-5efb60b4fca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9ad793290>]}
[0m16:05:39.387295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30abf4c2-7c21-46f9-8ffd-5efb60b4fca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9ad8dc450>]}
[0m16:05:39.387970 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:05:39.388614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30abf4c2-7c21-46f9-8ffd-5efb60b4fca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9ad8c0e10>]}
[0m16:05:39.390239 [info ] [MainThread]: 
[0m16:05:39.391530 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:05:39.393170 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydatabase'
[0m16:05:39.402980 [debug] [ThreadPool]: Using postgres connection "list_mydatabase"
[0m16:05:39.403622 [debug] [ThreadPool]: On list_mydatabase: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase"} */

    select distinct nspname from pg_namespace
  
[0m16:05:39.404270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:39.413876 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m16:05:39.415302 [debug] [ThreadPool]: On list_mydatabase: Close
[0m16:05:39.417060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydatabase, now list_mydatabase_default)
[0m16:05:39.423473 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_default"
[0m16:05:39.424182 [debug] [ThreadPool]: On list_mydatabase_default: BEGIN
[0m16:05:39.424794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:39.432752 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:05:39.433328 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_default"
[0m16:05:39.433927 [debug] [ThreadPool]: On list_mydatabase_default: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase_default"} */
select
      'mydatabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'default'
    union all
    select
      'mydatabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'default'
    union all
    select
      'mydatabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'default'
  
[0m16:05:39.437251 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:05:39.438610 [debug] [ThreadPool]: On list_mydatabase_default: ROLLBACK
[0m16:05:39.439904 [debug] [ThreadPool]: On list_mydatabase_default: Close
[0m16:05:39.444228 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:39.444844 [debug] [MainThread]: On master: BEGIN
[0m16:05:39.445432 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:05:39.453132 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:05:39.453721 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:39.454344 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:05:39.458272 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:05:39.459693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30abf4c2-7c21-46f9-8ffd-5efb60b4fca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9aff2c790>]}
[0m16:05:39.460323 [debug] [MainThread]: On master: ROLLBACK
[0m16:05:39.461620 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:39.462160 [debug] [MainThread]: On master: BEGIN
[0m16:05:39.464106 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:05:39.464672 [debug] [MainThread]: On master: COMMIT
[0m16:05:39.465205 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:39.465753 [debug] [MainThread]: On master: COMMIT
[0m16:05:39.467032 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:05:39.467611 [debug] [MainThread]: On master: Close
[0m16:05:39.468535 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:05:39.469151 [info ] [MainThread]: 
[0m16:05:39.475524 [debug] [Thread-1 (]: Began running node model.dbt_project.test
[0m16:05:39.476269 [info ] [Thread-1 (]: 1 of 1 START sql table model default.test ...................................... [RUN]
[0m16:05:39.477216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydatabase_default, now model.dbt_project.test)
[0m16:05:39.477853 [debug] [Thread-1 (]: Began compiling node model.dbt_project.test
[0m16:05:39.484125 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.test"
[0m16:05:39.488595 [debug] [Thread-1 (]: Timing info for model.dbt_project.test (compile): 16:05:39.478310 => 16:05:39.488393
[0m16:05:39.489297 [debug] [Thread-1 (]: Began executing node model.dbt_project.test
[0m16:05:39.524789 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.test"
[0m16:05:39.529032 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.test"
[0m16:05:39.529651 [debug] [Thread-1 (]: On model.dbt_project.test: BEGIN
[0m16:05:39.530253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:39.538822 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:05:39.539540 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.test"
[0m16:05:39.540157 [debug] [Thread-1 (]: On model.dbt_project.test: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.test"} */

  
    

  create  table "mydatabase"."default"."test__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM weather_data
  );
  
[0m16:05:39.544803 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m16:05:39.551068 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.test"
[0m16:05:39.551674 [debug] [Thread-1 (]: On model.dbt_project.test: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.test"} */
alter table "mydatabase"."default"."test" rename to "test__dbt_backup"
[0m16:05:39.553135 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:05:39.556144 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.test"
[0m16:05:39.556751 [debug] [Thread-1 (]: On model.dbt_project.test: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.test"} */
alter table "mydatabase"."default"."test__dbt_tmp" rename to "test"
[0m16:05:39.558560 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:05:39.577260 [debug] [Thread-1 (]: On model.dbt_project.test: COMMIT
[0m16:05:39.578048 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.test"
[0m16:05:39.578627 [debug] [Thread-1 (]: On model.dbt_project.test: COMMIT
[0m16:05:39.580754 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:05:39.586514 [debug] [Thread-1 (]: Applying DROP to: "mydatabase"."default"."test__dbt_backup"
[0m16:05:39.591447 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.test"
[0m16:05:39.592077 [debug] [Thread-1 (]: On model.dbt_project.test: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.test"} */
drop table if exists "mydatabase"."default"."test__dbt_backup" cascade
[0m16:05:39.598553 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:05:39.600618 [debug] [Thread-1 (]: Timing info for model.dbt_project.test (execute): 16:05:39.489779 => 16:05:39.600371
[0m16:05:39.601293 [debug] [Thread-1 (]: On model.dbt_project.test: Close
[0m16:05:39.602373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30abf4c2-7c21-46f9-8ffd-5efb60b4fca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9ada64810>]}
[0m16:05:39.603163 [info ] [Thread-1 (]: 1 of 1 OK created sql table model default.test ................................. [[32mSELECT 10[0m in 0.13s]
[0m16:05:39.604016 [debug] [Thread-1 (]: Finished running node model.dbt_project.test
[0m16:05:39.605805 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:39.606373 [debug] [MainThread]: On master: BEGIN
[0m16:05:39.606959 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:05:39.615508 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:05:39.616156 [debug] [MainThread]: On master: COMMIT
[0m16:05:39.616703 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:39.617238 [debug] [MainThread]: On master: COMMIT
[0m16:05:39.618514 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:05:39.619092 [debug] [MainThread]: On master: Close
[0m16:05:39.619999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:39.620529 [debug] [MainThread]: Connection 'model.dbt_project.test' was properly closed.
[0m16:05:39.621091 [info ] [MainThread]: 
[0m16:05:39.621737 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m16:05:39.622627 [debug] [MainThread]: Command end result
[0m16:05:39.636302 [info ] [MainThread]: 
[0m16:05:39.636978 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:05:39.637562 [info ] [MainThread]: 
[0m16:05:39.638169 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:05:39.639197 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5685899, "process_user_time": 1.889435, "process_kernel_time": 0.178999, "process_mem_max_rss": "110248", "process_out_blocks": "1312", "process_in_blocks": "0"}
[0m16:05:39.639906 [debug] [MainThread]: Command `dbt run` succeeded at 16:05:39.639801 after 0.57 seconds
[0m16:05:39.640481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9b30c7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9b3190450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9b3220cd0>]}
[0m16:05:39.641059 [debug] [MainThread]: Flushing usage events
[0m16:15:12.686546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f419296af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4192932bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4192968850>]}


============================== 16:15:12.692537 | e8b5cf20-0d81-43be-91bc-1ecb911139df ==============================
[0m16:15:12.692537 [info ] [MainThread]: Running with dbt=1.7.16
[0m16:15:12.693325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:15:12.817690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8b5cf20-0d81-43be-91bc-1ecb911139df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f419123d4d0>]}
[0m16:15:12.868375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8b5cf20-0d81-43be-91bc-1ecb911139df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f419293ac90>]}
[0m16:15:12.869340 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m16:15:12.876676 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m16:15:12.955805 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m16:15:12.956521 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/example/weather.sql
[0m16:15:12.957201 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/example/schema.yml
[0m16:15:12.957714 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://models/example/test.sql
[0m16:15:13.216579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8b5cf20-0d81-43be-91bc-1ecb911139df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41910ec410>]}
[0m16:15:13.233799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8b5cf20-0d81-43be-91bc-1ecb911139df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f417b424c90>]}
[0m16:15:13.234525 [info ] [MainThread]: Found 1 model, 8 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:15:13.235254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8b5cf20-0d81-43be-91bc-1ecb911139df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4191292050>]}
[0m16:15:13.237098 [info ] [MainThread]: 
[0m16:15:13.238198 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:15:13.239536 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydatabase'
[0m16:15:13.249553 [debug] [ThreadPool]: Using postgres connection "list_mydatabase"
[0m16:15:13.250130 [debug] [ThreadPool]: On list_mydatabase: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase"} */

    select distinct nspname from pg_namespace
  
[0m16:15:13.250792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:16.374189 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "192.168.2.19", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m16:15:38.340708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a09d89b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a0970ecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a0aaf0590>]}


============================== 16:15:38.345801 | 530de491-d233-4aa7-a373-066b6f1eaa37 ==============================
[0m16:15:38.345801 [info ] [MainThread]: Running with dbt=1.7.16
[0m16:15:38.346550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m16:15:38.464742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '530de491-d233-4aa7-a373-066b6f1eaa37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a07fdf310>]}
[0m16:15:38.514090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '530de491-d233-4aa7-a373-066b6f1eaa37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a08015f90>]}
[0m16:15:38.515176 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m16:15:38.522705 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m16:15:38.597046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:15:38.597613 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:15:38.602893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '530de491-d233-4aa7-a373-066b6f1eaa37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a09d8a310>]}
[0m16:15:38.620339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '530de491-d233-4aa7-a373-066b6f1eaa37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a07ef3990>]}
[0m16:15:38.621033 [info ] [MainThread]: Found 1 model, 8 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:15:38.621656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '530de491-d233-4aa7-a373-066b6f1eaa37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a097e4fd0>]}
[0m16:15:38.623341 [info ] [MainThread]: 
[0m16:15:38.624356 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:15:38.625572 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydatabase'
[0m16:15:38.635746 [debug] [ThreadPool]: Using postgres connection "list_mydatabase"
[0m16:15:38.636361 [debug] [ThreadPool]: On list_mydatabase: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase"} */

    select distinct nspname from pg_namespace
  
[0m16:15:38.636954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:38.646733 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m16:15:38.648237 [debug] [ThreadPool]: On list_mydatabase: Close
[0m16:15:38.650106 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydatabase, now list_mydatabase_default)
[0m16:15:38.655766 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_default"
[0m16:15:38.656325 [debug] [ThreadPool]: On list_mydatabase_default: BEGIN
[0m16:15:38.656843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:38.664866 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:15:38.665466 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_default"
[0m16:15:38.666058 [debug] [ThreadPool]: On list_mydatabase_default: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase_default"} */
select
      'mydatabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'default'
    union all
    select
      'mydatabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'default'
    union all
    select
      'mydatabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'default'
  
[0m16:15:38.669215 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:15:38.670555 [debug] [ThreadPool]: On list_mydatabase_default: ROLLBACK
[0m16:15:38.671821 [debug] [ThreadPool]: On list_mydatabase_default: Close
[0m16:15:38.676334 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:38.676906 [debug] [MainThread]: On master: BEGIN
[0m16:15:38.677403 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:15:38.685242 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:15:38.685790 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:38.686367 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:15:38.690541 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:15:38.692052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '530de491-d233-4aa7-a373-066b6f1eaa37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a07efd7d0>]}
[0m16:15:38.692739 [debug] [MainThread]: On master: ROLLBACK
[0m16:15:38.694056 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:38.694597 [debug] [MainThread]: On master: BEGIN
[0m16:15:38.696508 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:15:38.697060 [debug] [MainThread]: On master: COMMIT
[0m16:15:38.697585 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:38.698089 [debug] [MainThread]: On master: COMMIT
[0m16:15:38.699337 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:15:38.699877 [debug] [MainThread]: On master: Close
[0m16:15:38.700789 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:15:38.701387 [info ] [MainThread]: 
[0m16:15:38.707641 [debug] [Thread-1 (]: Began running node model.dbt_project.weather
[0m16:15:38.708345 [info ] [Thread-1 (]: 1 of 1 START sql table model default.weather ................................... [RUN]
[0m16:15:38.709268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydatabase_default, now model.dbt_project.weather)
[0m16:15:38.709830 [debug] [Thread-1 (]: Began compiling node model.dbt_project.weather
[0m16:15:38.715927 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.weather"
[0m16:15:38.720060 [debug] [Thread-1 (]: Timing info for model.dbt_project.weather (compile): 16:15:38.710269 => 16:15:38.719859
[0m16:15:38.720613 [debug] [Thread-1 (]: Began executing node model.dbt_project.weather
[0m16:15:38.755875 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.weather"
[0m16:15:38.760278 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m16:15:38.760844 [debug] [Thread-1 (]: On model.dbt_project.weather: BEGIN
[0m16:15:38.761396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:38.769817 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:15:38.770426 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m16:15:38.771084 [debug] [Thread-1 (]: On model.dbt_project.weather: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.weather"} */

  
    

  create  table "mydatabase"."default"."weather__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM weather_data
  );
  
[0m16:15:38.775880 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m16:15:38.781818 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m16:15:38.782511 [debug] [Thread-1 (]: On model.dbt_project.weather: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.weather"} */
alter table "mydatabase"."default"."weather__dbt_tmp" rename to "weather"
[0m16:15:38.783984 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:15:38.799899 [debug] [Thread-1 (]: On model.dbt_project.weather: COMMIT
[0m16:15:38.800632 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m16:15:38.801259 [debug] [Thread-1 (]: On model.dbt_project.weather: COMMIT
[0m16:15:38.803780 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:15:38.809567 [debug] [Thread-1 (]: Applying DROP to: "mydatabase"."default"."weather__dbt_backup"
[0m16:15:38.814503 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m16:15:38.815127 [debug] [Thread-1 (]: On model.dbt_project.weather: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.weather"} */
drop table if exists "mydatabase"."default"."weather__dbt_backup" cascade
[0m16:15:38.816521 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:15:38.818316 [debug] [Thread-1 (]: Timing info for model.dbt_project.weather (execute): 16:15:38.721087 => 16:15:38.818131
[0m16:15:38.818900 [debug] [Thread-1 (]: On model.dbt_project.weather: Close
[0m16:15:38.819973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '530de491-d233-4aa7-a373-066b6f1eaa37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a07e7dd50>]}
[0m16:15:38.820808 [info ] [Thread-1 (]: 1 of 1 OK created sql table model default.weather .............................. [[32mSELECT 11[0m in 0.11s]
[0m16:15:38.821696 [debug] [Thread-1 (]: Finished running node model.dbt_project.weather
[0m16:15:38.823361 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:38.823999 [debug] [MainThread]: On master: BEGIN
[0m16:15:38.824688 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:15:38.832700 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:15:38.833286 [debug] [MainThread]: On master: COMMIT
[0m16:15:38.833848 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:38.834371 [debug] [MainThread]: On master: COMMIT
[0m16:15:38.835648 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:15:38.836182 [debug] [MainThread]: On master: Close
[0m16:15:38.837060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:15:38.837614 [debug] [MainThread]: Connection 'model.dbt_project.weather' was properly closed.
[0m16:15:38.838176 [info ] [MainThread]: 
[0m16:15:38.838821 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m16:15:38.839697 [debug] [MainThread]: Command end result
[0m16:15:38.854213 [info ] [MainThread]: 
[0m16:15:38.854961 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:15:38.855539 [info ] [MainThread]: 
[0m16:15:38.856144 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:15:38.857153 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.56259227, "process_user_time": 1.972956, "process_kernel_time": 0.10015, "process_mem_max_rss": "109684", "process_out_blocks": "1312", "process_in_blocks": "0"}
[0m16:15:38.857887 [debug] [MainThread]: Command `dbt run` succeeded at 16:15:38.857777 after 0.56 seconds
[0m16:15:38.858456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a0d7047d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a099c6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a09d89ad0>]}
[0m16:15:38.859046 [debug] [MainThread]: Flushing usage events
[0m16:20:58.518158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2b3082f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2b4713090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2b3082b10>]}


============================== 16:20:58.523097 | 392bf899-a0a4-4f8f-b0ee-55e7e2c7eff5 ==============================
[0m16:20:58.523097 [info ] [MainThread]: Running with dbt=1.7.16
[0m16:20:58.523873 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/root', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:20:58.638194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '392bf899-a0a4-4f8f-b0ee-55e7e2c7eff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2b1988dd0>]}
[0m16:20:58.688047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '392bf899-a0a4-4f8f-b0ee-55e7e2c7eff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2b3082e90>]}
[0m16:20:58.689054 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m16:20:58.696330 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m16:20:58.773944 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:20:58.774722 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/example/weather.sql
[0m16:20:59.022598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '392bf899-a0a4-4f8f-b0ee-55e7e2c7eff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2b171fcd0>]}
[0m16:20:59.039204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '392bf899-a0a4-4f8f-b0ee-55e7e2c7eff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2b3107c90>]}
[0m16:20:59.039893 [info ] [MainThread]: Found 1 model, 8 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:20:59.040567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '392bf899-a0a4-4f8f-b0ee-55e7e2c7eff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2b19c9990>]}
[0m16:20:59.042349 [info ] [MainThread]: 
[0m16:20:59.043508 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:20:59.044830 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydatabase'
[0m16:20:59.054268 [debug] [ThreadPool]: Using postgres connection "list_mydatabase"
[0m16:20:59.054924 [debug] [ThreadPool]: On list_mydatabase: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase"} */

    select distinct nspname from pg_namespace
  
[0m16:20:59.055541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:59.067431 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:20:59.068849 [debug] [ThreadPool]: On list_mydatabase: Close
[0m16:20:59.070347 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydatabase, now create_mydatabase_default)
[0m16:20:59.071306 [debug] [ThreadPool]: Creating schema "database: "mydatabase"
schema: "default"
"
[0m16:20:59.076320 [debug] [ThreadPool]: Using postgres connection "create_mydatabase_default"
[0m16:20:59.076906 [debug] [ThreadPool]: On create_mydatabase_default: BEGIN
[0m16:20:59.077449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:59.085530 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:20:59.086080 [debug] [ThreadPool]: Using postgres connection "create_mydatabase_default"
[0m16:20:59.086611 [debug] [ThreadPool]: On create_mydatabase_default: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_mydatabase_default"} */
create schema if not exists "default"
[0m16:20:59.088084 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m16:20:59.089174 [debug] [ThreadPool]: On create_mydatabase_default: COMMIT
[0m16:20:59.089727 [debug] [ThreadPool]: Using postgres connection "create_mydatabase_default"
[0m16:20:59.090273 [debug] [ThreadPool]: On create_mydatabase_default: COMMIT
[0m16:20:59.092260 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m16:20:59.092830 [debug] [ThreadPool]: On create_mydatabase_default: Close
[0m16:20:59.094705 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_mydatabase_default, now list_mydatabase_default)
[0m16:20:59.100022 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_default"
[0m16:20:59.100584 [debug] [ThreadPool]: On list_mydatabase_default: BEGIN
[0m16:20:59.101144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:59.108783 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:20:59.109422 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_default"
[0m16:20:59.109956 [debug] [ThreadPool]: On list_mydatabase_default: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase_default"} */
select
      'mydatabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'default'
    union all
    select
      'mydatabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'default'
    union all
    select
      'mydatabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'default'
  
[0m16:20:59.113075 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:20:59.114335 [debug] [ThreadPool]: On list_mydatabase_default: ROLLBACK
[0m16:20:59.115584 [debug] [ThreadPool]: On list_mydatabase_default: Close
[0m16:20:59.119546 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:59.120202 [debug] [MainThread]: On master: BEGIN
[0m16:20:59.120737 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:59.128370 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:20:59.128913 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:59.129521 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:20:59.133065 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:20:59.134478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '392bf899-a0a4-4f8f-b0ee-55e7e2c7eff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2b16fda10>]}
[0m16:20:59.135103 [debug] [MainThread]: On master: ROLLBACK
[0m16:20:59.136401 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:59.136966 [debug] [MainThread]: On master: BEGIN
[0m16:20:59.138889 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:20:59.139420 [debug] [MainThread]: On master: COMMIT
[0m16:20:59.139935 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:59.140486 [debug] [MainThread]: On master: COMMIT
[0m16:20:59.141730 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:20:59.142263 [debug] [MainThread]: On master: Close
[0m16:20:59.143154 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:20:59.143750 [info ] [MainThread]: 
[0m16:20:59.149706 [debug] [Thread-1 (]: Began running node model.dbt_project.weather
[0m16:20:59.150473 [info ] [Thread-1 (]: 1 of 1 START sql table model default.weather ................................... [RUN]
[0m16:20:59.151412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydatabase_default, now model.dbt_project.weather)
[0m16:20:59.152048 [debug] [Thread-1 (]: Began compiling node model.dbt_project.weather
[0m16:20:59.158432 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.weather"
[0m16:20:59.162908 [debug] [Thread-1 (]: Timing info for model.dbt_project.weather (compile): 16:20:59.152591 => 16:20:59.162703
[0m16:20:59.163535 [debug] [Thread-1 (]: Began executing node model.dbt_project.weather
[0m16:20:59.199562 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.weather"
[0m16:20:59.203914 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m16:20:59.204492 [debug] [Thread-1 (]: On model.dbt_project.weather: BEGIN
[0m16:20:59.205050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:59.214041 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:20:59.214697 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m16:20:59.215274 [debug] [Thread-1 (]: On model.dbt_project.weather: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.weather"} */

  
    

  create  table "mydatabase"."default"."weather__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM weather_data;
  );
  
[0m16:20:59.216744 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 12:     SELECT * FROM weather_data;
                                       ^

[0m16:20:59.217326 [debug] [Thread-1 (]: On model.dbt_project.weather: ROLLBACK
[0m16:20:59.218760 [debug] [Thread-1 (]: Timing info for model.dbt_project.weather (execute): 16:20:59.164012 => 16:20:59.218556
[0m16:20:59.219369 [debug] [Thread-1 (]: On model.dbt_project.weather: Close
[0m16:20:59.222683 [debug] [Thread-1 (]: Database Error in model weather (models/example/weather.sql)
  syntax error at or near ";"
  LINE 12:     SELECT * FROM weather_data;
                                         ^
  compiled Code at target/run/dbt_project/models/example/weather.sql
[0m16:20:59.223361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '392bf899-a0a4-4f8f-b0ee-55e7e2c7eff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2b1759750>]}
[0m16:20:59.224144 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model default.weather .......................... [[31mERROR[0m in 0.07s]
[0m16:20:59.224988 [debug] [Thread-1 (]: Finished running node model.dbt_project.weather
[0m16:20:59.227128 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:59.227716 [debug] [MainThread]: On master: BEGIN
[0m16:20:59.228295 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:20:59.236048 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:20:59.236615 [debug] [MainThread]: On master: COMMIT
[0m16:20:59.237140 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:59.237657 [debug] [MainThread]: On master: COMMIT
[0m16:20:59.238925 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:20:59.239520 [debug] [MainThread]: On master: Close
[0m16:20:59.240385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:59.240905 [debug] [MainThread]: Connection 'model.dbt_project.weather' was properly closed.
[0m16:20:59.241518 [info ] [MainThread]: 
[0m16:20:59.242153 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m16:20:59.243013 [debug] [MainThread]: Command end result
[0m16:20:59.255867 [info ] [MainThread]: 
[0m16:20:59.256518 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:20:59.257126 [info ] [MainThread]: 
[0m16:20:59.257722 [error] [MainThread]:   Database Error in model weather (models/example/weather.sql)
  syntax error at or near ";"
  LINE 12:     SELECT * FROM weather_data;
                                         ^
  compiled Code at target/run/dbt_project/models/example/weather.sql
[0m16:20:59.258305 [info ] [MainThread]: 
[0m16:20:59.258925 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:20:59.260161 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7840569, "process_user_time": 2.120858, "process_kernel_time": 0.224321, "process_mem_max_rss": "117128", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m16:20:59.260919 [debug] [MainThread]: Command `dbt run` failed at 16:20:59.260808 after 0.78 seconds
[0m16:20:59.261529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2b3082590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2b30cf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2b30ced90>]}
[0m16:20:59.262110 [debug] [MainThread]: Flushing usage events
[0m16:27:36.079410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd9a41ad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd9a41a6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd9a41a890>]}


============================== 16:27:36.084494 | f52f2209-cfaf-4df7-b7c2-17c3ca50d720 ==============================
[0m16:27:36.084494 [info ] [MainThread]: Running with dbt=1.7.16
[0m16:27:36.085325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root', 'log_path': '/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:27:36.203051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f52f2209-cfaf-4df7-b7c2-17c3ca50d720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd98d65550>]}
[0m16:27:36.253661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f52f2209-cfaf-4df7-b7c2-17c3ca50d720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd9a422f90>]}
[0m16:27:36.254754 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m16:27:36.261719 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m16:27:36.273977 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:27:36.274607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f52f2209-cfaf-4df7-b7c2-17c3ca50d720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd9a483f10>]}
[0m16:27:37.278231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f52f2209-cfaf-4df7-b7c2-17c3ca50d720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd98b19cd0>]}
[0m16:27:37.294900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f52f2209-cfaf-4df7-b7c2-17c3ca50d720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd98a35790>]}
[0m16:27:37.295650 [info ] [MainThread]: Found 1 model, 8 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:27:37.296277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f52f2209-cfaf-4df7-b7c2-17c3ca50d720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd98c0b510>]}
[0m16:27:37.298093 [info ] [MainThread]: 
[0m16:27:37.299094 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:27:37.300367 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydatabase'
[0m16:27:37.309925 [debug] [ThreadPool]: Using postgres connection "list_mydatabase"
[0m16:27:37.310498 [debug] [ThreadPool]: On list_mydatabase: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase"} */

    select distinct nspname from pg_namespace
  
[0m16:27:37.311088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:27:37.320497 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m16:27:37.321854 [debug] [ThreadPool]: On list_mydatabase: Close
[0m16:27:37.323511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydatabase, now list_mydatabase_public)
[0m16:27:37.329178 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_public"
[0m16:27:37.329790 [debug] [ThreadPool]: On list_mydatabase_public: BEGIN
[0m16:27:37.330395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:27:37.338036 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:27:37.338585 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_public"
[0m16:27:37.339123 [debug] [ThreadPool]: On list_mydatabase_public: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase_public"} */
select
      'mydatabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'mydatabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'mydatabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:27:37.342107 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:27:37.343483 [debug] [ThreadPool]: On list_mydatabase_public: ROLLBACK
[0m16:27:37.344759 [debug] [ThreadPool]: On list_mydatabase_public: Close
[0m16:27:37.349139 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:37.349670 [debug] [MainThread]: On master: BEGIN
[0m16:27:37.350206 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:27:37.357699 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:27:37.358284 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:37.358892 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:27:37.362455 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:27:37.363973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f52f2209-cfaf-4df7-b7c2-17c3ca50d720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd9a47d050>]}
[0m16:27:37.364629 [debug] [MainThread]: On master: ROLLBACK
[0m16:27:37.366010 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:37.366557 [debug] [MainThread]: On master: BEGIN
[0m16:27:37.368587 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:27:37.369145 [debug] [MainThread]: On master: COMMIT
[0m16:27:37.369700 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:37.370276 [debug] [MainThread]: On master: COMMIT
[0m16:27:37.371624 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:27:37.372167 [debug] [MainThread]: On master: Close
[0m16:27:37.373052 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:27:37.373637 [info ] [MainThread]: 
[0m16:27:37.380245 [debug] [Thread-1 (]: Began running node model.dbt_project.weather
[0m16:27:37.381124 [info ] [Thread-1 (]: 1 of 1 START sql table model public.weather .................................... [RUN]
[0m16:27:37.382084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydatabase_public, now model.dbt_project.weather)
[0m16:27:37.382666 [debug] [Thread-1 (]: Began compiling node model.dbt_project.weather
[0m16:27:37.388920 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.weather"
[0m16:27:37.393324 [debug] [Thread-1 (]: Timing info for model.dbt_project.weather (compile): 16:27:37.383140 => 16:27:37.393121
[0m16:27:37.393930 [debug] [Thread-1 (]: Began executing node model.dbt_project.weather
[0m16:27:37.428723 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.weather"
[0m16:27:37.433064 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m16:27:37.433635 [debug] [Thread-1 (]: On model.dbt_project.weather: BEGIN
[0m16:27:37.434188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:37.442632 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:27:37.443238 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m16:27:37.443796 [debug] [Thread-1 (]: On model.dbt_project.weather: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.weather"} */

  
    

  create  table "mydatabase"."public"."weather__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM weather_data;
  );
  
[0m16:27:37.445254 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 12:     SELECT * FROM weather_data;
                                       ^

[0m16:27:37.445865 [debug] [Thread-1 (]: On model.dbt_project.weather: ROLLBACK
[0m16:27:37.447292 [debug] [Thread-1 (]: Timing info for model.dbt_project.weather (execute): 16:27:37.394411 => 16:27:37.447072
[0m16:27:37.447885 [debug] [Thread-1 (]: On model.dbt_project.weather: Close
[0m16:27:37.451259 [debug] [Thread-1 (]: Database Error in model weather (models/example/weather.sql)
  syntax error at or near ";"
  LINE 12:     SELECT * FROM weather_data;
                                         ^
  compiled Code at target/run/dbt_project/models/example/weather.sql
[0m16:27:37.451997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f52f2209-cfaf-4df7-b7c2-17c3ca50d720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd8af2c590>]}
[0m16:27:37.452767 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.weather ........................... [[31mERROR[0m in 0.07s]
[0m16:27:37.453628 [debug] [Thread-1 (]: Finished running node model.dbt_project.weather
[0m16:27:37.455715 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:37.456264 [debug] [MainThread]: On master: BEGIN
[0m16:27:37.456773 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:27:37.464384 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:27:37.464916 [debug] [MainThread]: On master: COMMIT
[0m16:27:37.465448 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:37.465971 [debug] [MainThread]: On master: COMMIT
[0m16:27:37.467179 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:27:37.467707 [debug] [MainThread]: On master: Close
[0m16:27:37.468578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:27:37.469114 [debug] [MainThread]: Connection 'model.dbt_project.weather' was properly closed.
[0m16:27:37.469666 [info ] [MainThread]: 
[0m16:27:37.470275 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m16:27:37.471091 [debug] [MainThread]: Command end result
[0m16:27:37.483372 [info ] [MainThread]: 
[0m16:27:37.483981 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:27:37.484509 [info ] [MainThread]: 
[0m16:27:37.485054 [error] [MainThread]:   Database Error in model weather (models/example/weather.sql)
  syntax error at or near ";"
  LINE 12:     SELECT * FROM weather_data;
                                         ^
  compiled Code at target/run/dbt_project/models/example/weather.sql
[0m16:27:37.485595 [info ] [MainThread]: 
[0m16:27:37.486165 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:27:37.487245 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4504477, "process_user_time": 2.864179, "process_kernel_time": 0.159121, "process_mem_max_rss": "118028", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m16:27:37.487990 [debug] [MainThread]: Command `dbt run` failed at 16:27:37.487881 after 1.45 seconds
[0m16:27:37.488545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd9a46e010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd9b2a8cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd9e580310>]}
[0m16:27:37.489101 [debug] [MainThread]: Flushing usage events
[0m16:28:56.512496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d7988ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d7988c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d7989850>]}


============================== 16:28:56.517463 | bb305cbb-1c92-4581-aa13-d2690bb0f0d1 ==============================
[0m16:28:56.517463 [info ] [MainThread]: Running with dbt=1.7.16
[0m16:28:56.518377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:28:56.635747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb305cbb-1c92-4581-aa13-d2690bb0f0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d79ebe10>]}
[0m16:28:56.685714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb305cbb-1c92-4581-aa13-d2690bb0f0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d62bbfd0>]}
[0m16:28:56.686796 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m16:28:56.694103 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m16:28:56.775952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:28:56.776856 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/example/weather.sql
[0m16:28:57.025224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb305cbb-1c92-4581-aa13-d2690bb0f0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d8025dd0>]}
[0m16:28:57.042421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb305cbb-1c92-4581-aa13-d2690bb0f0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d6173ed0>]}
[0m16:28:57.043189 [info ] [MainThread]: Found 1 model, 8 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:28:57.043819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb305cbb-1c92-4581-aa13-d2690bb0f0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d629fe90>]}
[0m16:28:57.045708 [info ] [MainThread]: 
[0m16:28:57.046785 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:28:57.048222 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydatabase'
[0m16:28:57.057647 [debug] [ThreadPool]: Using postgres connection "list_mydatabase"
[0m16:28:57.058224 [debug] [ThreadPool]: On list_mydatabase: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase"} */

    select distinct nspname from pg_namespace
  
[0m16:28:57.058758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:57.068176 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m16:28:57.069557 [debug] [ThreadPool]: On list_mydatabase: Close
[0m16:28:57.071333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydatabase, now list_mydatabase_public)
[0m16:28:57.076770 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_public"
[0m16:28:57.077337 [debug] [ThreadPool]: On list_mydatabase_public: BEGIN
[0m16:28:57.077872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:28:57.085497 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:28:57.086034 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_public"
[0m16:28:57.086558 [debug] [ThreadPool]: On list_mydatabase_public: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase_public"} */
select
      'mydatabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'mydatabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'mydatabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:28:57.089543 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:28:57.090987 [debug] [ThreadPool]: On list_mydatabase_public: ROLLBACK
[0m16:28:57.092354 [debug] [ThreadPool]: On list_mydatabase_public: Close
[0m16:28:57.096773 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:57.097460 [debug] [MainThread]: On master: BEGIN
[0m16:28:57.098074 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:28:57.106175 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:28:57.106959 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:57.107596 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:28:57.111564 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:28:57.113428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb305cbb-1c92-4581-aa13-d2690bb0f0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d629e0d0>]}
[0m16:28:57.114181 [debug] [MainThread]: On master: ROLLBACK
[0m16:28:57.115677 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:57.116281 [debug] [MainThread]: On master: BEGIN
[0m16:28:57.118319 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:28:57.118895 [debug] [MainThread]: On master: COMMIT
[0m16:28:57.119426 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:57.120017 [debug] [MainThread]: On master: COMMIT
[0m16:28:57.121275 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:28:57.121840 [debug] [MainThread]: On master: Close
[0m16:28:57.122821 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:28:57.123476 [info ] [MainThread]: 
[0m16:28:57.129647 [debug] [Thread-1 (]: Began running node model.dbt_project.weather
[0m16:28:57.130457 [info ] [Thread-1 (]: 1 of 1 START sql table model public.weather .................................... [RUN]
[0m16:28:57.131429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydatabase_public, now model.dbt_project.weather)
[0m16:28:57.132032 [debug] [Thread-1 (]: Began compiling node model.dbt_project.weather
[0m16:28:57.139035 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.weather"
[0m16:28:57.143620 [debug] [Thread-1 (]: Timing info for model.dbt_project.weather (compile): 16:28:57.132523 => 16:28:57.143406
[0m16:28:57.144222 [debug] [Thread-1 (]: Began executing node model.dbt_project.weather
[0m16:28:57.181353 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.weather"
[0m16:28:57.185733 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m16:28:57.186309 [debug] [Thread-1 (]: On model.dbt_project.weather: BEGIN
[0m16:28:57.186861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:57.195533 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:28:57.196144 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m16:28:57.196718 [debug] [Thread-1 (]: On model.dbt_project.weather: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.weather"} */

  
    

  create  table "mydatabase"."public"."weather__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "mydatabase"."mydatabase"."weather_data";
  );
  
[0m16:28:57.198101 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 12:     SELECT * FROM "mydatabase"."mydatabase"."weather_data";
                                                                   ^

[0m16:28:57.198727 [debug] [Thread-1 (]: On model.dbt_project.weather: ROLLBACK
[0m16:28:57.200232 [debug] [Thread-1 (]: Timing info for model.dbt_project.weather (execute): 16:28:57.144686 => 16:28:57.199983
[0m16:28:57.200850 [debug] [Thread-1 (]: On model.dbt_project.weather: Close
[0m16:28:57.204048 [debug] [Thread-1 (]: Database Error in model weather (models/example/weather.sql)
  syntax error at or near ";"
  LINE 12:     SELECT * FROM "mydatabase"."mydatabase"."weather_data";
                                                                     ^
  compiled Code at target/run/dbt_project/models/example/weather.sql
[0m16:28:57.204771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb305cbb-1c92-4581-aa13-d2690bb0f0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d4579150>]}
[0m16:28:57.205590 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.weather ........................... [[31mERROR[0m in 0.07s]
[0m16:28:57.206406 [debug] [Thread-1 (]: Finished running node model.dbt_project.weather
[0m16:28:57.208775 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:57.209409 [debug] [MainThread]: On master: BEGIN
[0m16:28:57.209999 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:28:57.218218 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:28:57.218805 [debug] [MainThread]: On master: COMMIT
[0m16:28:57.219334 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:57.219839 [debug] [MainThread]: On master: COMMIT
[0m16:28:57.221118 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:28:57.221675 [debug] [MainThread]: On master: Close
[0m16:28:57.222542 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:28:57.223138 [debug] [MainThread]: Connection 'model.dbt_project.weather' was properly closed.
[0m16:28:57.223841 [info ] [MainThread]: 
[0m16:28:57.224443 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m16:28:57.225321 [debug] [MainThread]: Command end result
[0m16:28:57.238156 [info ] [MainThread]: 
[0m16:28:57.238818 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:28:57.239465 [info ] [MainThread]: 
[0m16:28:57.240078 [error] [MainThread]:   Database Error in model weather (models/example/weather.sql)
  syntax error at or near ";"
  LINE 12:     SELECT * FROM "mydatabase"."mydatabase"."weather_data";
                                                                     ^
  compiled Code at target/run/dbt_project/models/example/weather.sql
[0m16:28:57.240650 [info ] [MainThread]: 
[0m16:28:57.241236 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:28:57.242207 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.77385277, "process_user_time": 2.149449, "process_kernel_time": 0.162222, "process_mem_max_rss": "115400", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m16:28:57.242981 [debug] [MainThread]: Command `dbt run` failed at 16:28:57.242848 after 0.77 seconds
[0m16:28:57.243655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d7988950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d798a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d87fa5d0>]}
[0m16:28:57.244276 [debug] [MainThread]: Flushing usage events
[0m16:29:16.377929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc51ff3ae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc51ff3ad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc51ff3b3d0>]}


============================== 16:29:16.382912 | 1604f53c-2ea6-4ded-84dc-74aca0ac2b7f ==============================
[0m16:29:16.382912 [info ] [MainThread]: Running with dbt=1.7.16
[0m16:29:16.383820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:29:16.501922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1604f53c-2ea6-4ded-84dc-74aca0ac2b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc51e840dd0>]}
[0m16:29:16.551695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1604f53c-2ea6-4ded-84dc-74aca0ac2b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc51ff6b0d0>]}
[0m16:29:16.552535 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m16:29:16.559662 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m16:29:16.635489 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:29:16.636116 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:29:16.641455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1604f53c-2ea6-4ded-84dc-74aca0ac2b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc51e7ec790>]}
[0m16:29:16.658065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1604f53c-2ea6-4ded-84dc-74aca0ac2b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc51e777410>]}
[0m16:29:16.658791 [info ] [MainThread]: Found 1 model, 8 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:29:16.659489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1604f53c-2ea6-4ded-84dc-74aca0ac2b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc51e88e310>]}
[0m16:29:16.661515 [info ] [MainThread]: 
[0m16:29:16.662654 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:29:16.663967 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydatabase'
[0m16:29:16.674096 [debug] [ThreadPool]: Using postgres connection "list_mydatabase"
[0m16:29:16.674681 [debug] [ThreadPool]: On list_mydatabase: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase"} */

    select distinct nspname from pg_namespace
  
[0m16:29:16.675225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:16.684756 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m16:29:16.686141 [debug] [ThreadPool]: On list_mydatabase: Close
[0m16:29:16.688036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydatabase, now list_mydatabase_public)
[0m16:29:16.693693 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_public"
[0m16:29:16.694352 [debug] [ThreadPool]: On list_mydatabase_public: BEGIN
[0m16:29:16.694896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:29:16.702573 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:29:16.703163 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_public"
[0m16:29:16.703756 [debug] [ThreadPool]: On list_mydatabase_public: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase_public"} */
select
      'mydatabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'mydatabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'mydatabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:29:16.706880 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:29:16.708291 [debug] [ThreadPool]: On list_mydatabase_public: ROLLBACK
[0m16:29:16.709755 [debug] [ThreadPool]: On list_mydatabase_public: Close
[0m16:29:16.714199 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:16.714834 [debug] [MainThread]: On master: BEGIN
[0m16:29:16.715365 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:29:16.723455 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:29:16.724057 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:16.724657 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:29:16.728359 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:29:16.730081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1604f53c-2ea6-4ded-84dc-74aca0ac2b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5207b8250>]}
[0m16:29:16.730766 [debug] [MainThread]: On master: ROLLBACK
[0m16:29:16.732195 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:16.732771 [debug] [MainThread]: On master: BEGIN
[0m16:29:16.734749 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:29:16.735411 [debug] [MainThread]: On master: COMMIT
[0m16:29:16.735943 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:16.736487 [debug] [MainThread]: On master: COMMIT
[0m16:29:16.737987 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:29:16.738572 [debug] [MainThread]: On master: Close
[0m16:29:16.739564 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:29:16.740264 [info ] [MainThread]: 
[0m16:29:16.746542 [debug] [Thread-1 (]: Began running node model.dbt_project.weather
[0m16:29:16.747450 [info ] [Thread-1 (]: 1 of 1 START sql table model public.weather .................................... [RUN]
[0m16:29:16.748518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydatabase_public, now model.dbt_project.weather)
[0m16:29:16.749158 [debug] [Thread-1 (]: Began compiling node model.dbt_project.weather
[0m16:29:16.756342 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.weather"
[0m16:29:16.761003 [debug] [Thread-1 (]: Timing info for model.dbt_project.weather (compile): 16:29:16.749643 => 16:29:16.760799
[0m16:29:16.761603 [debug] [Thread-1 (]: Began executing node model.dbt_project.weather
[0m16:29:16.797385 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.weather"
[0m16:29:16.802191 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m16:29:16.802824 [debug] [Thread-1 (]: On model.dbt_project.weather: BEGIN
[0m16:29:16.803431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:29:16.812063 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:29:16.812684 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m16:29:16.813271 [debug] [Thread-1 (]: On model.dbt_project.weather: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.weather"} */

  
    

  create  table "mydatabase"."public"."weather__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "mydatabase"."mydatabase"."weather_data";
  );
  
[0m16:29:16.814742 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 12:     SELECT * FROM "mydatabase"."mydatabase"."weather_data";
                                                                   ^

[0m16:29:16.815444 [debug] [Thread-1 (]: On model.dbt_project.weather: ROLLBACK
[0m16:29:16.816935 [debug] [Thread-1 (]: Timing info for model.dbt_project.weather (execute): 16:29:16.762066 => 16:29:16.816734
[0m16:29:16.817531 [debug] [Thread-1 (]: On model.dbt_project.weather: Close
[0m16:29:16.820908 [debug] [Thread-1 (]: Database Error in model weather (models/example/weather.sql)
  syntax error at or near ";"
  LINE 12:     SELECT * FROM "mydatabase"."mydatabase"."weather_data";
                                                                     ^
  compiled Code at target/run/dbt_project/models/example/weather.sql
[0m16:29:16.821592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1604f53c-2ea6-4ded-84dc-74aca0ac2b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc51e62ba50>]}
[0m16:29:16.822376 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.weather ........................... [[31mERROR[0m in 0.07s]
[0m16:29:16.823260 [debug] [Thread-1 (]: Finished running node model.dbt_project.weather
[0m16:29:16.825443 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:16.826098 [debug] [MainThread]: On master: BEGIN
[0m16:29:16.826616 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:16.834503 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:29:16.835182 [debug] [MainThread]: On master: COMMIT
[0m16:29:16.835727 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:16.836255 [debug] [MainThread]: On master: COMMIT
[0m16:29:16.837492 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:29:16.838190 [debug] [MainThread]: On master: Close
[0m16:29:16.839106 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:16.839743 [debug] [MainThread]: Connection 'model.dbt_project.weather' was properly closed.
[0m16:29:16.840395 [info ] [MainThread]: 
[0m16:29:16.841075 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m16:29:16.841991 [debug] [MainThread]: Command end result
[0m16:29:16.855435 [info ] [MainThread]: 
[0m16:29:16.856208 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:29:16.856837 [info ] [MainThread]: 
[0m16:29:16.857474 [error] [MainThread]:   Database Error in model weather (models/example/weather.sql)
  syntax error at or near ";"
  LINE 12:     SELECT * FROM "mydatabase"."mydatabase"."weather_data";
                                                                     ^
  compiled Code at target/run/dbt_project/models/example/weather.sql
[0m16:29:16.858142 [info ] [MainThread]: 
[0m16:29:16.858788 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:29:16.859897 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5250451, "process_user_time": 1.903656, "process_kernel_time": 0.128893, "process_mem_max_rss": "110600", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m16:29:16.860661 [debug] [MainThread]: Command `dbt run` failed at 16:29:16.860543 after 0.53 seconds
[0m16:29:16.861281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc51ff88ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5205de7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5204af190>]}
[0m16:29:16.861989 [debug] [MainThread]: Flushing usage events
[0m16:30:12.992756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a9f1c1890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a9f1c01d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a9f1fb5d0>]}


============================== 16:30:12.997633 | 765e09be-be00-4686-a009-043d37284158 ==============================
[0m16:30:12.997633 [info ] [MainThread]: Running with dbt=1.7.16
[0m16:30:12.998490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:30:13.113679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '765e09be-be00-4686-a009-043d37284158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a9f2186d0>]}
[0m16:30:13.163181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '765e09be-be00-4686-a009-043d37284158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a9f1aee10>]}
[0m16:30:13.164101 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m16:30:13.171183 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m16:30:13.246977 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:30:13.247787 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/example/weather.sql
[0m16:30:13.497004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '765e09be-be00-4686-a009-043d37284158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a9d925510>]}
[0m16:30:13.513483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '765e09be-be00-4686-a009-043d37284158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a9c080690>]}
[0m16:30:13.514191 [info ] [MainThread]: Found 1 model, 8 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:30:13.514896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '765e09be-be00-4686-a009-043d37284158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a9d9bb150>]}
[0m16:30:13.516708 [info ] [MainThread]: 
[0m16:30:13.517799 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:30:13.519420 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydatabase'
[0m16:30:13.529408 [debug] [ThreadPool]: Using postgres connection "list_mydatabase"
[0m16:30:13.530144 [debug] [ThreadPool]: On list_mydatabase: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase"} */

    select distinct nspname from pg_namespace
  
[0m16:30:13.530713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:30:13.541001 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m16:30:13.542480 [debug] [ThreadPool]: On list_mydatabase: Close
[0m16:30:13.544188 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydatabase, now list_mydatabase_public)
[0m16:30:13.549840 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_public"
[0m16:30:13.550410 [debug] [ThreadPool]: On list_mydatabase_public: BEGIN
[0m16:30:13.550946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:13.558645 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:30:13.559209 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_public"
[0m16:30:13.559764 [debug] [ThreadPool]: On list_mydatabase_public: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase_public"} */
select
      'mydatabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'mydatabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'mydatabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:30:13.562845 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:30:13.564177 [debug] [ThreadPool]: On list_mydatabase_public: ROLLBACK
[0m16:30:13.565478 [debug] [ThreadPool]: On list_mydatabase_public: Close
[0m16:30:13.569801 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:13.570419 [debug] [MainThread]: On master: BEGIN
[0m16:30:13.570985 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:30:13.578608 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:30:13.579170 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:13.579773 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:30:13.583269 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:30:13.584704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '765e09be-be00-4686-a009-043d37284158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a9fa42310>]}
[0m16:30:13.585388 [debug] [MainThread]: On master: ROLLBACK
[0m16:30:13.586727 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:13.587312 [debug] [MainThread]: On master: BEGIN
[0m16:30:13.589597 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:30:13.590203 [debug] [MainThread]: On master: COMMIT
[0m16:30:13.590830 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:13.591355 [debug] [MainThread]: On master: COMMIT
[0m16:30:13.592603 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:30:13.593204 [debug] [MainThread]: On master: Close
[0m16:30:13.594113 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:30:13.594781 [info ] [MainThread]: 
[0m16:30:13.601135 [debug] [Thread-1 (]: Began running node model.dbt_project.weather
[0m16:30:13.601878 [info ] [Thread-1 (]: 1 of 1 START sql table model public.weather .................................... [RUN]
[0m16:30:13.602887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydatabase_public, now model.dbt_project.weather)
[0m16:30:13.603501 [debug] [Thread-1 (]: Began compiling node model.dbt_project.weather
[0m16:30:13.610502 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.weather"
[0m16:30:13.615031 [debug] [Thread-1 (]: Timing info for model.dbt_project.weather (compile): 16:30:13.603986 => 16:30:13.614829
[0m16:30:13.615681 [debug] [Thread-1 (]: Began executing node model.dbt_project.weather
[0m16:30:13.651443 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.weather"
[0m16:30:13.655983 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m16:30:13.656574 [debug] [Thread-1 (]: On model.dbt_project.weather: BEGIN
[0m16:30:13.657182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:13.665598 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:30:13.666243 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m16:30:13.666823 [debug] [Thread-1 (]: On model.dbt_project.weather: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.weather"} */

  
    

  create  table "mydatabase"."public"."weather__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "mydatabase"."mydatabase"."weather_data"
  );
  
[0m16:30:13.668312 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "mydatabase.weather_data" does not exist
LINE 12:     SELECT * FROM "mydatabase"."mydatabase"."weather_data"
                           ^

[0m16:30:13.669005 [debug] [Thread-1 (]: On model.dbt_project.weather: ROLLBACK
[0m16:30:13.670479 [debug] [Thread-1 (]: Timing info for model.dbt_project.weather (execute): 16:30:13.616163 => 16:30:13.670280
[0m16:30:13.671112 [debug] [Thread-1 (]: On model.dbt_project.weather: Close
[0m16:30:13.674635 [debug] [Thread-1 (]: Database Error in model weather (models/example/weather.sql)
  relation "mydatabase.weather_data" does not exist
  LINE 12:     SELECT * FROM "mydatabase"."mydatabase"."weather_data"
                             ^
  compiled Code at target/run/dbt_project/models/example/weather.sql
[0m16:30:13.675399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '765e09be-be00-4686-a009-043d37284158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a7bd35b50>]}
[0m16:30:13.676280 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.weather ........................... [[31mERROR[0m in 0.07s]
[0m16:30:13.677148 [debug] [Thread-1 (]: Finished running node model.dbt_project.weather
[0m16:30:13.679281 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:13.679930 [debug] [MainThread]: On master: BEGIN
[0m16:30:13.680450 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:30:13.688844 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:30:13.689485 [debug] [MainThread]: On master: COMMIT
[0m16:30:13.690041 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:13.690603 [debug] [MainThread]: On master: COMMIT
[0m16:30:13.691977 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:30:13.692556 [debug] [MainThread]: On master: Close
[0m16:30:13.693453 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:30:13.694044 [debug] [MainThread]: Connection 'model.dbt_project.weather' was properly closed.
[0m16:30:13.694626 [info ] [MainThread]: 
[0m16:30:13.695313 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m16:30:13.696289 [debug] [MainThread]: Command end result
[0m16:30:13.710012 [info ] [MainThread]: 
[0m16:30:13.710811 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:30:13.711508 [info ] [MainThread]: 
[0m16:30:13.712173 [error] [MainThread]:   Database Error in model weather (models/example/weather.sql)
  relation "mydatabase.weather_data" does not exist
  LINE 12:     SELECT * FROM "mydatabase"."mydatabase"."weather_data"
                             ^
  compiled Code at target/run/dbt_project/models/example/weather.sql
[0m16:30:13.712807 [info ] [MainThread]: 
[0m16:30:13.713451 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:30:13.714565 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7639064, "process_user_time": 2.10293, "process_kernel_time": 0.160223, "process_mem_max_rss": "117000", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m16:30:13.715334 [debug] [MainThread]: Command `dbt run` failed at 16:30:13.715220 after 0.76 seconds
[0m16:30:13.715923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a9f1ddc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a9f1fd1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aa31787d0>]}
[0m16:30:13.716483 [debug] [MainThread]: Flushing usage events
[0m16:31:57.030813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7989529290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f798955e0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7989d73fd0>]}


============================== 16:31:57.036133 | ac285483-67a8-4ef4-a6bb-c652552c4390 ==============================
[0m16:31:57.036133 [info ] [MainThread]: Running with dbt=1.7.16
[0m16:31:57.036949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:31:57.154356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac285483-67a8-4ef4-a6bb-c652552c4390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7987e5aad0>]}
[0m16:31:57.203463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac285483-67a8-4ef4-a6bb-c652552c4390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7989516d50>]}
[0m16:31:57.204411 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m16:31:57.212134 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m16:31:57.286605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:31:57.287495 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/example/weather.sql
[0m16:31:57.523206 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.weather' (models/example/weather.sql) depends on a source named 'public.weather_data' which was not found
[0m16:31:57.524611 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5372431, "process_user_time": 2.003843, "process_kernel_time": 0.120834, "process_mem_max_rss": "107600", "process_out_blocks": "1216", "command_success": false, "process_in_blocks": "0"}
[0m16:31:57.525394 [debug] [MainThread]: Command `dbt run` failed at 16:31:57.525277 after 0.54 seconds
[0m16:31:57.526052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79895155d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7989516350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7989515550>]}
[0m16:31:57.526733 [debug] [MainThread]: Flushing usage events
[0m16:32:24.972688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c951267d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c951269d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c95126890>]}


============================== 16:32:24.977555 | eb14ec34-a435-4b21-b2cd-e1893372a80d ==============================
[0m16:32:24.977555 [info ] [MainThread]: Running with dbt=1.7.16
[0m16:32:24.978392 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:32:25.092675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb14ec34-a435-4b21-b2cd-e1893372a80d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c95983c90>]}
[0m16:32:25.142410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb14ec34-a435-4b21-b2cd-e1893372a80d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c93aa7610>]}
[0m16:32:25.143333 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m16:32:25.150407 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m16:32:25.226553 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:32:25.227490 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/example/weather.sql
[0m16:32:25.325339 [error] [MainThread]: Encountered an error:
Compilation Error in model weather (models/example/weather.sql)
  source() takes exactly two arguments (1 given)
[0m16:32:25.326642 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.39613888, "process_user_time": 1.905521, "process_kernel_time": 0.070203, "process_mem_max_rss": "104684", "process_out_blocks": "1216", "command_success": false, "process_in_blocks": "0"}
[0m16:32:25.327404 [debug] [MainThread]: Command `dbt run` failed at 16:32:25.327293 after 0.40 seconds
[0m16:32:25.328006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c9512db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c957c9d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c990fc7d0>]}
[0m16:32:25.328804 [debug] [MainThread]: Flushing usage events
[0m17:11:28.369354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ba0b2ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ba0b2cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ba0b2c10>]}


============================== 17:11:28.374155 | ebb05dce-8534-42d2-80a0-f03669ffecef ==============================
[0m17:11:28.374155 [info ] [MainThread]: Running with dbt=1.7.16
[0m17:11:28.375181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/root', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m17:11:28.490669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebb05dce-8534-42d2-80a0-f03669ffecef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b89b5e10>]}
[0m17:11:28.539930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebb05dce-8534-42d2-80a0-f03669ffecef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ba0b2dd0>]}
[0m17:11:28.540866 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m17:11:28.548228 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m17:11:28.624936 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:11:28.625770 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/example/weather.sql
[0m17:11:28.873157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebb05dce-8534-42d2-80a0-f03669ffecef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b886ec10>]}
[0m17:11:28.890582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebb05dce-8534-42d2-80a0-f03669ffecef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ba112ed0>]}
[0m17:11:28.891311 [info ] [MainThread]: Found 1 model, 8 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:11:28.892012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebb05dce-8534-42d2-80a0-f03669ffecef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b8a67c50>]}
[0m17:11:28.893880 [info ] [MainThread]: 
[0m17:11:28.895035 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:11:28.896361 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydatabase'
[0m17:11:28.905716 [debug] [ThreadPool]: Using postgres connection "list_mydatabase"
[0m17:11:28.906356 [debug] [ThreadPool]: On list_mydatabase: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase"} */

    select distinct nspname from pg_namespace
  
[0m17:11:28.907008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:28.916895 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:11:28.918352 [debug] [ThreadPool]: On list_mydatabase: Close
[0m17:11:28.920096 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydatabase, now list_mydatabase_public)
[0m17:11:28.925564 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_public"
[0m17:11:28.926160 [debug] [ThreadPool]: On list_mydatabase_public: BEGIN
[0m17:11:28.926703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:28.934418 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:11:28.934990 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_public"
[0m17:11:28.935570 [debug] [ThreadPool]: On list_mydatabase_public: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase_public"} */
select
      'mydatabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'mydatabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'mydatabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:11:28.938783 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:11:28.940196 [debug] [ThreadPool]: On list_mydatabase_public: ROLLBACK
[0m17:11:28.941767 [debug] [ThreadPool]: On list_mydatabase_public: Close
[0m17:11:28.946211 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:28.946902 [debug] [MainThread]: On master: BEGIN
[0m17:11:28.947558 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:11:28.955464 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:11:28.956062 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:28.956656 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:11:28.960371 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m17:11:28.961828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebb05dce-8534-42d2-80a0-f03669ffecef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b88bfed0>]}
[0m17:11:28.962476 [debug] [MainThread]: On master: ROLLBACK
[0m17:11:28.963805 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:28.964339 [debug] [MainThread]: On master: BEGIN
[0m17:11:28.966375 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:11:28.966943 [debug] [MainThread]: On master: COMMIT
[0m17:11:28.967501 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:28.968023 [debug] [MainThread]: On master: COMMIT
[0m17:11:28.969271 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:11:28.969820 [debug] [MainThread]: On master: Close
[0m17:11:28.970715 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:11:28.971542 [info ] [MainThread]: 
[0m17:11:28.977770 [debug] [Thread-1 (]: Began running node model.dbt_project.weather
[0m17:11:28.978535 [info ] [Thread-1 (]: 1 of 1 START sql table model public.weather .................................... [RUN]
[0m17:11:28.979682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydatabase_public, now model.dbt_project.weather)
[0m17:11:28.980272 [debug] [Thread-1 (]: Began compiling node model.dbt_project.weather
[0m17:11:28.987825 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.weather"
[0m17:11:28.992381 [debug] [Thread-1 (]: Timing info for model.dbt_project.weather (compile): 17:11:28.980789 => 17:11:28.992179
[0m17:11:28.993073 [debug] [Thread-1 (]: Began executing node model.dbt_project.weather
[0m17:11:29.028529 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.weather"
[0m17:11:29.032906 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m17:11:29.033510 [debug] [Thread-1 (]: On model.dbt_project.weather: BEGIN
[0m17:11:29.034142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:29.042477 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:11:29.043122 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m17:11:29.043719 [debug] [Thread-1 (]: On model.dbt_project.weather: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.weather"} */

  
    

  create  table "mydatabase"."public"."weather__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "mydatabase"."mydatabase"."weather_data";
  );
  
[0m17:11:29.045222 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 12:     SELECT * FROM "mydatabase"."mydatabase"."weather_data";
                                                                   ^

[0m17:11:29.045904 [debug] [Thread-1 (]: On model.dbt_project.weather: ROLLBACK
[0m17:11:29.047361 [debug] [Thread-1 (]: Timing info for model.dbt_project.weather (execute): 17:11:28.993608 => 17:11:29.047161
[0m17:11:29.048002 [debug] [Thread-1 (]: On model.dbt_project.weather: Close
[0m17:11:29.051495 [debug] [Thread-1 (]: Database Error in model weather (models/example/weather.sql)
  syntax error at or near ";"
  LINE 12:     SELECT * FROM "mydatabase"."mydatabase"."weather_data";
                                                                     ^
  compiled Code at target/run/dbt_project/models/example/weather.sql
[0m17:11:29.052274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebb05dce-8534-42d2-80a0-f03669ffecef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b8788a50>]}
[0m17:11:29.053066 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.weather ........................... [[31mERROR[0m in 0.07s]
[0m17:11:29.054003 [debug] [Thread-1 (]: Finished running node model.dbt_project.weather
[0m17:11:29.056135 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:29.056704 [debug] [MainThread]: On master: BEGIN
[0m17:11:29.057251 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:11:29.066335 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:11:29.066920 [debug] [MainThread]: On master: COMMIT
[0m17:11:29.067508 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:29.068060 [debug] [MainThread]: On master: COMMIT
[0m17:11:29.069317 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:11:29.069884 [debug] [MainThread]: On master: Close
[0m17:11:29.070775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:29.071314 [debug] [MainThread]: Connection 'model.dbt_project.weather' was properly closed.
[0m17:11:29.071904 [info ] [MainThread]: 
[0m17:11:29.072575 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m17:11:29.073468 [debug] [MainThread]: Command end result
[0m17:11:29.087066 [info ] [MainThread]: 
[0m17:11:29.087808 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:11:29.088536 [info ] [MainThread]: 
[0m17:11:29.089219 [error] [MainThread]:   Database Error in model weather (models/example/weather.sql)
  syntax error at or near ";"
  LINE 12:     SELECT * FROM "mydatabase"."mydatabase"."weather_data";
                                                                     ^
  compiled Code at target/run/dbt_project/models/example/weather.sql
[0m17:11:29.089890 [info ] [MainThread]: 
[0m17:11:29.090602 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:11:29.091631 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7646231, "process_user_time": 2.171908, "process_kernel_time": 0.089256, "process_mem_max_rss": "117108", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m17:11:29.092359 [debug] [MainThread]: Command `dbt run` failed at 17:11:29.092252 after 0.77 seconds
[0m17:11:29.092974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ba0fa410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ba0fa990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22be08c650>]}
[0m17:11:29.093569 [debug] [MainThread]: Flushing usage events
[0m17:18:51.087553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1097e2aad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1097e2ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1097e2ac90>]}


============================== 17:18:51.092968 | cb980531-0132-40ef-a8de-a84c343b18c7 ==============================
[0m17:18:51.092968 [info ] [MainThread]: Running with dbt=1.7.16
[0m17:18:51.094024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:18:51.210182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb980531-0132-40ef-a8de-a84c343b18c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f109677f7d0>]}
[0m17:18:51.259249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb980531-0132-40ef-a8de-a84c343b18c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1097e57710>]}
[0m17:18:51.260103 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m17:18:51.267611 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m17:18:51.345147 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:18:51.346176 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/example/weather.sql
[0m17:18:51.600523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb980531-0132-40ef-a8de-a84c343b18c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10963f8790>]}
[0m17:18:51.619035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb980531-0132-40ef-a8de-a84c343b18c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1096599610>]}
[0m17:18:51.619693 [info ] [MainThread]: Found 1 model, 8 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:18:51.620381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb980531-0132-40ef-a8de-a84c343b18c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10965e8310>]}
[0m17:18:51.622219 [info ] [MainThread]: 
[0m17:18:51.623290 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:18:51.624730 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydatabase'
[0m17:18:51.634308 [debug] [ThreadPool]: Using postgres connection "list_mydatabase"
[0m17:18:51.634905 [debug] [ThreadPool]: On list_mydatabase: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase"} */

    select distinct nspname from pg_namespace
  
[0m17:18:51.635443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:51.644964 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:18:51.646370 [debug] [ThreadPool]: On list_mydatabase: Close
[0m17:18:51.648336 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydatabase, now list_mydatabase_public)
[0m17:18:51.653802 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_public"
[0m17:18:51.654445 [debug] [ThreadPool]: On list_mydatabase_public: BEGIN
[0m17:18:51.655078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:18:51.663109 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:18:51.663748 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_public"
[0m17:18:51.664330 [debug] [ThreadPool]: On list_mydatabase_public: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase_public"} */
select
      'mydatabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'mydatabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'mydatabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:18:51.667407 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:18:51.668779 [debug] [ThreadPool]: On list_mydatabase_public: ROLLBACK
[0m17:18:51.670123 [debug] [ThreadPool]: On list_mydatabase_public: Close
[0m17:18:51.674575 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:51.675154 [debug] [MainThread]: On master: BEGIN
[0m17:18:51.675707 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:18:51.683752 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:18:51.684345 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:51.684941 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:18:51.688591 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m17:18:51.690265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb980531-0132-40ef-a8de-a84c343b18c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1096201110>]}
[0m17:18:51.690914 [debug] [MainThread]: On master: ROLLBACK
[0m17:18:51.692162 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:51.692717 [debug] [MainThread]: On master: BEGIN
[0m17:18:51.694728 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:18:51.695283 [debug] [MainThread]: On master: COMMIT
[0m17:18:51.695833 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:51.696351 [debug] [MainThread]: On master: COMMIT
[0m17:18:51.697697 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:18:51.698339 [debug] [MainThread]: On master: Close
[0m17:18:51.699258 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:18:51.699920 [info ] [MainThread]: 
[0m17:18:51.706608 [debug] [Thread-1 (]: Began running node model.dbt_project.weather
[0m17:18:51.707339 [info ] [Thread-1 (]: 1 of 1 START sql table model public.weather .................................... [RUN]
[0m17:18:51.708419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydatabase_public, now model.dbt_project.weather)
[0m17:18:51.709015 [debug] [Thread-1 (]: Began compiling node model.dbt_project.weather
[0m17:18:51.715750 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.weather"
[0m17:18:51.720245 [debug] [Thread-1 (]: Timing info for model.dbt_project.weather (compile): 17:18:51.709490 => 17:18:51.720043
[0m17:18:51.720957 [debug] [Thread-1 (]: Began executing node model.dbt_project.weather
[0m17:18:51.756873 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.weather"
[0m17:18:51.761263 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m17:18:51.761867 [debug] [Thread-1 (]: On model.dbt_project.weather: BEGIN
[0m17:18:51.762479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:51.770990 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:18:51.771637 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m17:18:51.772233 [debug] [Thread-1 (]: On model.dbt_project.weather: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.weather"} */

  
    

  create  table "mydatabase"."public"."weather__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM <dbt.context.providers.RuntimeSourceResolver object at 0x7f1096283a90>
  );
  
[0m17:18:51.773646 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "<"
LINE 12:     SELECT * FROM <dbt.context.providers.RuntimeSourceResolv...
                           ^

[0m17:18:51.774313 [debug] [Thread-1 (]: On model.dbt_project.weather: ROLLBACK
[0m17:18:51.775762 [debug] [Thread-1 (]: Timing info for model.dbt_project.weather (execute): 17:18:51.721508 => 17:18:51.775563
[0m17:18:51.776346 [debug] [Thread-1 (]: On model.dbt_project.weather: Close
[0m17:18:51.779602 [debug] [Thread-1 (]: Database Error in model weather (models/example/weather.sql)
  syntax error at or near "<"
  LINE 12:     SELECT * FROM <dbt.context.providers.RuntimeSourceResolv...
                             ^
  compiled Code at target/run/dbt_project/models/example/weather.sql
[0m17:18:51.780267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb980531-0132-40ef-a8de-a84c343b18c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1096226310>]}
[0m17:18:51.781050 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.weather ........................... [[31mERROR[0m in 0.07s]
[0m17:18:51.781924 [debug] [Thread-1 (]: Finished running node model.dbt_project.weather
[0m17:18:51.784225 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:51.784800 [debug] [MainThread]: On master: BEGIN
[0m17:18:51.785333 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:18:51.793738 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:18:51.794361 [debug] [MainThread]: On master: COMMIT
[0m17:18:51.794894 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:51.795429 [debug] [MainThread]: On master: COMMIT
[0m17:18:51.796716 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:18:51.797262 [debug] [MainThread]: On master: Close
[0m17:18:51.798181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:51.798802 [debug] [MainThread]: Connection 'model.dbt_project.weather' was properly closed.
[0m17:18:51.799386 [info ] [MainThread]: 
[0m17:18:51.800072 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m17:18:51.800971 [debug] [MainThread]: Command end result
[0m17:18:51.814433 [info ] [MainThread]: 
[0m17:18:51.815254 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:18:51.815915 [info ] [MainThread]: 
[0m17:18:51.816608 [error] [MainThread]:   Database Error in model weather (models/example/weather.sql)
  syntax error at or near "<"
  LINE 12:     SELECT * FROM <dbt.context.providers.RuntimeSourceResolv...
                             ^
  compiled Code at target/run/dbt_project/models/example/weather.sql
[0m17:18:51.817315 [info ] [MainThread]: 
[0m17:18:51.817995 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:18:51.819061 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7738378, "process_user_time": 2.134984, "process_kernel_time": 0.131539, "process_mem_max_rss": "114988", "process_out_blocks": "1312", "command_success": false, "process_in_blocks": "0"}
[0m17:18:51.819796 [debug] [MainThread]: Command `dbt run` failed at 17:18:51.819687 after 0.77 seconds
[0m17:18:51.820393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1097e2a290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1097e63490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1097e638d0>]}
[0m17:18:51.820976 [debug] [MainThread]: Flushing usage events


============================== 2024-06-13 12:44:22.695093 | 8368ef93-daa9-49f2-a5de-aa99bb069103 ==============================
[0m12:44:22.695093 [info ] [MainThread]: Running with dbt=1.4.7
[0m12:44:22.697066 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:44:22.697618 [debug] [MainThread]: Tracking: tracking
[0m12:44:22.698918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe10ac43a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe10ac4820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe10ac4400>]}
[0m12:44:22.708275 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m12:44:22.729387 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m12:44:22.730181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8368ef93-daa9-49f2-a5de-aa99bb069103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe10ac6e60>]}
[0m12:44:23.319345 [debug] [MainThread]: 1699: static parser successfully parsed example/weather.sql
[0m12:44:23.396422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe10a62830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe109f3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe109f13c0>]}
[0m12:44:23.397253 [debug] [MainThread]: Flushing usage events
[0m12:44:23.575191 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.weather' (models/example/weather.sql) depends on a source named 'my_database.weather_data' which was not found


============================== 2024-06-13 12:50:30.765638 | 88b50d9b-0b5b-44fd-b965-5448efe48c6a ==============================
[0m12:50:30.765638 [info ] [MainThread]: Running with dbt=1.4.7
[0m12:50:30.767694 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:50:30.768175 [debug] [MainThread]: Tracking: tracking
[0m12:50:30.769523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f318ba610f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f318ba617b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f318ba61390>]}
[0m12:50:30.778994 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m12:50:30.794504 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m12:50:30.795123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '88b50d9b-0b5b-44fd-b965-5448efe48c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f318ba29b10>]}
[0m12:50:31.427753 [debug] [MainThread]: 1699: static parser successfully parsed example/weather.sql
[0m12:50:31.505009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f318a1c2d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f318a1ae020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f318a1ae110>]}
[0m12:50:31.506045 [debug] [MainThread]: Flushing usage events
[0m12:50:31.728582 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.weather' (models/example/weather.sql) depends on a source named 'my_database.weather_data' which was not found


============================== 2024-06-13 12:52:59.440187 | f2a94b17-719a-4cf4-92ba-489ccdf020f7 ==============================
[0m12:52:59.440187 [info ] [MainThread]: Running with dbt=1.4.7
[0m12:52:59.442172 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:52:59.442617 [debug] [MainThread]: Tracking: tracking
[0m12:52:59.443945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b15d10f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b15d17b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b15d1390>]}
[0m12:52:59.454015 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m12:52:59.469423 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m12:52:59.470197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f2a94b17-719a-4cf4-92ba-489ccdf020f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b1599ae0>]}
[0m12:53:00.082704 [debug] [MainThread]: 1699: static parser successfully parsed example/weather.sql
[0m12:53:00.165252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6afd2ed40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6afd1a050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6afd1a2c0>]}
[0m12:53:00.166123 [debug] [MainThread]: Flushing usage events
[0m12:53:00.312833 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.weather' (models/example/weather.sql) depends on a source named 'my_database.weather_data' which was not found


============================== 2024-06-13 12:57:05.385717 | d43711eb-6293-4a44-bdaf-63d8113c56cf ==============================
[0m12:57:05.385717 [info ] [MainThread]: Running with dbt=1.4.7
[0m12:57:05.388173 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:57:05.388979 [debug] [MainThread]: Tracking: tracking
[0m12:57:05.391080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d0d4610f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d0d4617b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d0d461390>]}
[0m12:57:05.404183 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m12:57:05.421880 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m12:57:05.422764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd43711eb-6293-4a44-bdaf-63d8113c56cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d0d429b40>]}
[0m12:57:06.134253 [debug] [MainThread]: 1699: static parser successfully parsed example/weather.sql
[0m12:57:06.225087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d0bbbedd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d0bbab2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d0bbaa320>]}
[0m12:57:06.226044 [debug] [MainThread]: Flushing usage events
[0m12:57:06.425916 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.weather' (models/example/weather.sql) depends on a source named 'my_database.weather_data' which was not found


============================== 2024-06-13 13:00:19.696721 | 7771f2c7-0f5e-4ace-8ede-602137c5de04 ==============================
[0m13:00:19.696721 [info ] [MainThread]: Running with dbt=1.4.7
[0m13:00:19.698508 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:00:19.698943 [debug] [MainThread]: Tracking: tracking
[0m13:00:19.700246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a77d50b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a77d53010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a77d50b20>]}
[0m13:00:19.709747 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m13:00:19.724552 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m13:00:19.725271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7771f2c7-0f5e-4ace-8ede-602137c5de04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a77d52230>]}
[0m13:00:20.286940 [debug] [MainThread]: 1699: static parser successfully parsed example/weather.sql
[0m13:00:20.361597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a76422c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a7640cd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a7640c2e0>]}
[0m13:00:20.362310 [debug] [MainThread]: Flushing usage events
[0m13:00:20.508615 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.weather' (models/example/weather.sql) depends on a source named 'my_database.weather_data' which was not found


============================== 2024-06-13 13:05:12.899175 | c173ec20-5aff-4988-9636-0d5f5d87b0ae ==============================
[0m13:05:12.899175 [info ] [MainThread]: Running with dbt=1.4.7
[0m13:05:12.901155 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:05:12.901620 [debug] [MainThread]: Tracking: tracking
[0m13:05:12.903624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eb48650f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eb48657b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eb4865390>]}
[0m13:05:12.919868 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m13:05:12.947985 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m13:05:12.949043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c173ec20-5aff-4988-9636-0d5f5d87b0ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eb482dae0>]}
[0m13:05:13.612948 [debug] [MainThread]: 1699: static parser successfully parsed example/weather.sql
[0m13:05:13.721364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c173ec20-5aff-4988-9636-0d5f5d87b0ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eb30891e0>]}
[0m13:05:13.732712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c173ec20-5aff-4988-9636-0d5f5d87b0ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eb2fb18a0>]}
[0m13:05:13.733410 [info ] [MainThread]: Found 1 model, 9 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:05:13.734099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c173ec20-5aff-4988-9636-0d5f5d87b0ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eb487c7f0>]}
[0m13:05:13.735763 [info ] [MainThread]: 
[0m13:05:13.737845 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:05:13.739134 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydatabase'
[0m13:05:13.749625 [debug] [ThreadPool]: Using postgres connection "list_mydatabase"
[0m13:05:13.750342 [debug] [ThreadPool]: On list_mydatabase: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase"} */

    select distinct nspname from pg_namespace
  
[0m13:05:13.750915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:13.769620 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m13:05:13.771209 [debug] [ThreadPool]: On list_mydatabase: Close
[0m13:05:13.772843 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydatabase_public'
[0m13:05:13.778411 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_public"
[0m13:05:13.778946 [debug] [ThreadPool]: On list_mydatabase_public: BEGIN
[0m13:05:13.779402 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:13.788419 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:05:13.789197 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_public"
[0m13:05:13.789708 [debug] [ThreadPool]: On list_mydatabase_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase_public"} */
select
      'mydatabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'mydatabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:05:13.792951 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m13:05:13.795023 [debug] [ThreadPool]: On list_mydatabase_public: ROLLBACK
[0m13:05:13.796495 [debug] [ThreadPool]: On list_mydatabase_public: Close
[0m13:05:13.802261 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:13.802905 [debug] [MainThread]: On master: BEGIN
[0m13:05:13.803428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:05:13.811899 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:05:13.812442 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:13.812930 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:05:13.816939 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m13:05:13.818279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c173ec20-5aff-4988-9636-0d5f5d87b0ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eb2f873d0>]}
[0m13:05:13.818999 [debug] [MainThread]: On master: ROLLBACK
[0m13:05:13.820542 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:13.821039 [debug] [MainThread]: On master: BEGIN
[0m13:05:13.822978 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:05:13.823448 [debug] [MainThread]: On master: COMMIT
[0m13:05:13.823950 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:13.824411 [debug] [MainThread]: On master: COMMIT
[0m13:05:13.825766 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:05:13.826368 [debug] [MainThread]: On master: Close
[0m13:05:13.827330 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:05:13.827955 [info ] [MainThread]: 
[0m13:05:13.844465 [debug] [Thread-1 (]: Began running node model.dbt_project.weather
[0m13:05:13.845268 [info ] [Thread-1 (]: 1 of 1 START sql table model public.weather .................................... [RUN]
[0m13:05:13.846178 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.weather'
[0m13:05:13.846683 [debug] [Thread-1 (]: Began compiling node model.dbt_project.weather
[0m13:05:13.849513 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.weather"
[0m13:05:13.853844 [debug] [Thread-1 (]: Timing info for model.dbt_project.weather (compile): 2024-06-13 13:05:13.847067 => 2024-06-13 13:05:13.853762
[0m13:05:13.854376 [debug] [Thread-1 (]: Began executing node model.dbt_project.weather
[0m13:05:13.896335 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.weather"
[0m13:05:13.900973 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m13:05:13.901535 [debug] [Thread-1 (]: On model.dbt_project.weather: BEGIN
[0m13:05:13.902067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:13.912044 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:05:13.912839 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m13:05:13.913411 [debug] [Thread-1 (]: On model.dbt_project.weather: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.weather"} */

  
    

  create  table "mydatabase"."public"."weather__dbt_tmp"
  as (
    SELECT * FROM "mydatabase"."my_database"."weather_data"
  );
  
[0m13:05:13.914969 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "my_database.weather_data" does not exist
LINE 8:     SELECT * FROM "mydatabase"."my_database"."weather_data"
                          ^

[0m13:05:13.915494 [debug] [Thread-1 (]: On model.dbt_project.weather: ROLLBACK
[0m13:05:13.917060 [debug] [Thread-1 (]: Timing info for model.dbt_project.weather (execute): 2024-06-13 13:05:13.854844 => 2024-06-13 13:05:13.916980
[0m13:05:13.917544 [debug] [Thread-1 (]: On model.dbt_project.weather: Close
[0m13:05:13.922838 [debug] [Thread-1 (]: Database Error in model weather (models/example/weather.sql)
  relation "my_database.weather_data" does not exist
  LINE 8:     SELECT * FROM "mydatabase"."my_database"."weather_data"
                            ^
  compiled Code at target/run/dbt_project/models/example/weather.sql
[0m13:05:13.923537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c173ec20-5aff-4988-9636-0d5f5d87b0ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eb1666ce0>]}
[0m13:05:13.924189 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.weather ........................... [[31mERROR[0m in 0.08s]
[0m13:05:13.925973 [debug] [Thread-1 (]: Finished running node model.dbt_project.weather
[0m13:05:13.927531 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:05:13.928036 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:13.928584 [debug] [MainThread]: On master: BEGIN
[0m13:05:13.929011 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:05:13.937905 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:05:13.938625 [debug] [MainThread]: On master: COMMIT
[0m13:05:13.939245 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:13.939780 [debug] [MainThread]: On master: COMMIT
[0m13:05:13.941429 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:05:13.942084 [debug] [MainThread]: On master: Close
[0m13:05:13.942997 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:05:13.943554 [debug] [MainThread]: Connection 'model.dbt_project.weather' was properly closed.
[0m13:05:13.944214 [info ] [MainThread]: 
[0m13:05:13.944965 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m13:05:13.945663 [debug] [MainThread]: Command end result
[0m13:05:13.956900 [info ] [MainThread]: 
[0m13:05:13.957783 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:05:13.958437 [info ] [MainThread]: 
[0m13:05:13.959146 [error] [MainThread]: [33mDatabase Error in model weather (models/example/weather.sql)[0m
[0m13:05:13.959772 [error] [MainThread]:   relation "my_database.weather_data" does not exist
[0m13:05:13.960376 [error] [MainThread]:   LINE 8:     SELECT * FROM "mydatabase"."my_database"."weather_data"
[0m13:05:13.960990 [error] [MainThread]:                             ^
[0m13:05:13.961645 [error] [MainThread]:   compiled Code at target/run/dbt_project/models/example/weather.sql
[0m13:05:13.962274 [info ] [MainThread]: 
[0m13:05:13.962917 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:05:13.963719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eb305e440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eb48341f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eb487c7f0>]}
[0m13:05:13.964364 [debug] [MainThread]: Flushing usage events


============================== 2024-06-13 13:06:55.026515 | b8d464ac-aa67-4fdd-b104-29f40a43a657 ==============================
[0m13:06:55.026515 [info ] [MainThread]: Running with dbt=1.4.7
[0m13:06:55.028511 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:06:55.029043 [debug] [MainThread]: Tracking: tracking
[0m13:06:55.030305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3449044b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3449046fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3449044b20>]}
[0m13:06:55.041959 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m13:06:55.119253 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:06:55.119818 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:06:55.125569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8d464ac-aa67-4fdd-b104-29f40a43a657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34476d2440>]}
[0m13:06:55.135455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8d464ac-aa67-4fdd-b104-29f40a43a657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3447817a30>]}
[0m13:06:55.136012 [info ] [MainThread]: Found 1 model, 9 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:06:55.136614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8d464ac-aa67-4fdd-b104-29f40a43a657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f344a94b9a0>]}
[0m13:06:55.138072 [info ] [MainThread]: 
[0m13:06:55.140083 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:06:55.141318 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydatabase'
[0m13:06:55.151530 [debug] [ThreadPool]: Using postgres connection "list_mydatabase"
[0m13:06:55.152088 [debug] [ThreadPool]: On list_mydatabase: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase"} */

    select distinct nspname from pg_namespace
  
[0m13:06:55.152626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:55.162040 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m13:06:55.163334 [debug] [ThreadPool]: On list_mydatabase: Close
[0m13:06:55.164949 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydatabase_public'
[0m13:06:55.170110 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_public"
[0m13:06:55.170686 [debug] [ThreadPool]: On list_mydatabase_public: BEGIN
[0m13:06:55.171205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:06:55.179186 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:06:55.179677 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_public"
[0m13:06:55.180140 [debug] [ThreadPool]: On list_mydatabase_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase_public"} */
select
      'mydatabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'mydatabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:06:55.182672 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m13:06:55.184007 [debug] [ThreadPool]: On list_mydatabase_public: ROLLBACK
[0m13:06:55.185163 [debug] [ThreadPool]: On list_mydatabase_public: Close
[0m13:06:55.190578 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:55.191107 [debug] [MainThread]: On master: BEGIN
[0m13:06:55.191610 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:06:55.201285 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:06:55.201958 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:55.202447 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:06:55.206115 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m13:06:55.207442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8d464ac-aa67-4fdd-b104-29f40a43a657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3447716a70>]}
[0m13:06:55.208006 [debug] [MainThread]: On master: ROLLBACK
[0m13:06:55.209220 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:55.209672 [debug] [MainThread]: On master: BEGIN
[0m13:06:55.211713 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:06:55.212115 [debug] [MainThread]: On master: COMMIT
[0m13:06:55.212554 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:55.212980 [debug] [MainThread]: On master: COMMIT
[0m13:06:55.214128 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:06:55.214575 [debug] [MainThread]: On master: Close
[0m13:06:55.215361 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:06:55.215924 [info ] [MainThread]: 
[0m13:06:55.218806 [debug] [Thread-1 (]: Began running node model.dbt_project.weather
[0m13:06:55.219397 [info ] [Thread-1 (]: 1 of 1 START sql table model public.weather .................................... [RUN]
[0m13:06:55.220282 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.weather'
[0m13:06:55.220806 [debug] [Thread-1 (]: Began compiling node model.dbt_project.weather
[0m13:06:55.223605 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.weather"
[0m13:06:55.227723 [debug] [Thread-1 (]: Timing info for model.dbt_project.weather (compile): 2024-06-13 13:06:55.221239 => 2024-06-13 13:06:55.227652
[0m13:06:55.228353 [debug] [Thread-1 (]: Began executing node model.dbt_project.weather
[0m13:06:55.263220 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.weather"
[0m13:06:55.267513 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m13:06:55.268019 [debug] [Thread-1 (]: On model.dbt_project.weather: BEGIN
[0m13:06:55.268467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:06:55.276576 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:06:55.277114 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m13:06:55.277561 [debug] [Thread-1 (]: On model.dbt_project.weather: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.weather"} */

  
    

  create  table "mydatabase"."public"."weather__dbt_tmp"
  as (
    SELECT * FROM "mydatabase"."my_database"."weather_data"
  );
  
[0m13:06:55.278953 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "my_database.weather_data" does not exist
LINE 8:     SELECT * FROM "mydatabase"."my_database"."weather_data"
                          ^

[0m13:06:55.279410 [debug] [Thread-1 (]: On model.dbt_project.weather: ROLLBACK
[0m13:06:55.280651 [debug] [Thread-1 (]: Timing info for model.dbt_project.weather (execute): 2024-06-13 13:06:55.228803 => 2024-06-13 13:06:55.280589
[0m13:06:55.281117 [debug] [Thread-1 (]: On model.dbt_project.weather: Close
[0m13:06:55.283084 [debug] [Thread-1 (]: Database Error in model weather (models/example/weather.sql)
  relation "my_database.weather_data" does not exist
  LINE 8:     SELECT * FROM "mydatabase"."my_database"."weather_data"
                            ^
  compiled Code at target/run/dbt_project/models/example/weather.sql
[0m13:06:55.283689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d464ac-aa67-4fdd-b104-29f40a43a657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f344753d720>]}
[0m13:06:55.284313 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.weather ........................... [[31mERROR[0m in 0.06s]
[0m13:06:55.286086 [debug] [Thread-1 (]: Finished running node model.dbt_project.weather
[0m13:06:55.287603 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:06:55.288072 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:55.288503 [debug] [MainThread]: On master: BEGIN
[0m13:06:55.288997 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:06:55.297011 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:06:55.297544 [debug] [MainThread]: On master: COMMIT
[0m13:06:55.297979 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:55.298473 [debug] [MainThread]: On master: COMMIT
[0m13:06:55.299658 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:06:55.300138 [debug] [MainThread]: On master: Close
[0m13:06:55.300891 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:06:55.301421 [debug] [MainThread]: Connection 'model.dbt_project.weather' was properly closed.
[0m13:06:55.302039 [info ] [MainThread]: 
[0m13:06:55.302706 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m13:06:55.303440 [debug] [MainThread]: Command end result
[0m13:06:55.313300 [info ] [MainThread]: 
[0m13:06:55.314114 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:06:55.314787 [info ] [MainThread]: 
[0m13:06:55.315538 [error] [MainThread]: [33mDatabase Error in model weather (models/example/weather.sql)[0m
[0m13:06:55.316107 [error] [MainThread]:   relation "my_database.weather_data" does not exist
[0m13:06:55.316674 [error] [MainThread]:   LINE 8:     SELECT * FROM "mydatabase"."my_database"."weather_data"
[0m13:06:55.317273 [error] [MainThread]:                             ^
[0m13:06:55.317808 [error] [MainThread]:   compiled Code at target/run/dbt_project/models/example/weather.sql
[0m13:06:55.318378 [info ] [MainThread]: 
[0m13:06:55.318921 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:06:55.319645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3447565300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3447817670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f344753e170>]}
[0m13:06:55.320204 [debug] [MainThread]: Flushing usage events


============================== 2024-06-13 17:30:05.029759 | a81474d0-22dd-4d78-8dea-40279c284e72 ==============================
[0m17:30:05.029759 [info ] [MainThread]: Running with dbt=1.4.7
[0m17:30:05.031761 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:30:05.032252 [debug] [MainThread]: Tracking: tracking
[0m17:30:05.033796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f131aa2d0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f131aa2d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f131aa2d390>]}
[0m17:30:05.049805 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m17:30:05.073856 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:30:05.074717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a81474d0-22dd-4d78-8dea-40279c284e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f131aa2c0d0>]}
[0m17:30:05.720366 [debug] [MainThread]: 1699: static parser successfully parsed example/weather.sql
[0m17:30:05.832900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a81474d0-22dd-4d78-8dea-40279c284e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1319127400>]}
[0m17:30:05.844544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a81474d0-22dd-4d78-8dea-40279c284e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13191274c0>]}
[0m17:30:05.845270 [info ] [MainThread]: Found 1 model, 9 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:30:05.845874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a81474d0-22dd-4d78-8dea-40279c284e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13191188b0>]}
[0m17:30:05.847407 [info ] [MainThread]: 
[0m17:30:05.849399 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:30:05.850697 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydatabase'
[0m17:30:05.861287 [debug] [ThreadPool]: Using postgres connection "list_mydatabase"
[0m17:30:05.861966 [debug] [ThreadPool]: On list_mydatabase: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase"} */

    select distinct nspname from pg_namespace
  
[0m17:30:05.862489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:13.868538 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Temporary failure in name resolution

[0m17:30:21.872621 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase"} */

    select distinct nspname from pg_namespace
  
[0m17:30:21.873443 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m17:30:21.874046 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m17:30:21.874552 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m17:30:21.875067 [debug] [ThreadPool]: On list_mydatabase: No close available on handle
[0m17:30:21.876267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:21.876719 [debug] [MainThread]: Connection 'list_mydatabase' was properly closed.
[0m17:30:21.877727 [info ] [MainThread]: 
[0m17:30:21.878271 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 16.03 seconds (16.03s).
[0m17:30:21.878826 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Temporary failure in name resolution
  
[0m17:30:21.879417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1319127910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13139496f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1313949600>]}
[0m17:30:21.879891 [debug] [MainThread]: Flushing usage events


============================== 2024-06-13 17:38:53.654361 | 38466af4-afea-4b54-acfd-014332cf9323 ==============================
[0m17:38:53.654361 [info ] [MainThread]: Running with dbt=1.4.7
[0m17:38:53.656317 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:38:53.656850 [debug] [MainThread]: Tracking: tracking
[0m17:38:53.658233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd514b71360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd514b717e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd514b713c0>]}
[0m17:38:53.670885 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m17:38:53.757489 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:38:53.758171 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:38:53.764971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38466af4-afea-4b54-acfd-014332cf9323', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5132865c0>]}
[0m17:38:53.777466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38466af4-afea-4b54-acfd-014332cf9323', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5133a3be0>]}
[0m17:38:53.778426 [info ] [MainThread]: Found 1 model, 9 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:38:53.779020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38466af4-afea-4b54-acfd-014332cf9323', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5133a3c40>]}
[0m17:38:53.780667 [info ] [MainThread]: 
[0m17:38:53.782728 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:38:53.784161 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydatabase'
[0m17:38:53.798954 [debug] [ThreadPool]: Using postgres connection "list_mydatabase"
[0m17:38:53.799856 [debug] [ThreadPool]: On list_mydatabase: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase"} */

    select distinct nspname from pg_namespace
  
[0m17:38:53.800472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:01.804731 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Temporary failure in name resolution

[0m17:39:09.803205 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase"} */

    select distinct nspname from pg_namespace
  
[0m17:39:09.803890 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m17:39:09.804400 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m17:39:09.804856 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m17:39:09.805325 [debug] [ThreadPool]: On list_mydatabase: No close available on handle
[0m17:39:09.806497 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:39:09.806947 [debug] [MainThread]: Connection 'list_mydatabase' was properly closed.
[0m17:39:09.807479 [info ] [MainThread]: 
[0m17:39:09.808034 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 16.03 seconds (16.03s).
[0m17:39:09.808592 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Temporary failure in name resolution
  
[0m17:39:09.809174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5133a3a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5132ceb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5132cea10>]}
[0m17:39:09.809674 [debug] [MainThread]: Flushing usage events
[0m17:12:56.009007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC3C4DBD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC3F179DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC3F179C10>]}


============================== 17:12:56.024630 | ee62d93b-fd59-4abd-83ad-4bfd28ab8877 ==============================
[0m17:12:56.024630 [info ] [MainThread]: Running with dbt=1.8.2
[0m17:12:56.024630 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jackt\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\jackt\\PycharmProjects\\pythonProject\\etl_project\\dbt_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:12:56.480995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee62d93b-fd59-4abd-83ad-4bfd28ab8877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC3F261370>]}
[0m17:12:56.527875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee62d93b-fd59-4abd-83ad-4bfd28ab8877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC3BEFF130>]}
[0m17:12:56.527875 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m17:12:56.543496 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m17:12:56.606000 [debug] [MainThread]: Failed to load parsed file from disk at C:\Users\jackt\PycharmProjects\pythonProject\etl_project\dbt_project\target\partial_parse.msgpack: Field "nodes" of type MutableMapping[str, Union[AnalysisNode, SingularTestNode, HookNode, ModelNode, SqlNode, GenericTestNode, SnapshotNode, UnitTestNode, SeedNode]] in Manifest has invalid value {'model.dbt_project.weather': {'database': 'mydatabase', 'schema': 'public', 'name': 'weather', 'resource_type': 'model', 'package_name': 'dbt_project', 'path': 'example/weather.sql', 'original_file_path': 'models/example/weather.sql', 'unique_id': 'model.dbt_project.weather', 'fqn': ['dbt_project', 'example', 'weather'], 'alias': 'weather', 'checksum': {'name': 'sha256', 'checksum': '4d6dd1bc5c1b263d2c43dc187b55c443e77c32fa5bbc90dbd6bd83d2a11ee76d'}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'incremental_strategy': None, 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'packages': [], 'docs': {'show': True, 'node_color': None}, 'post-hook': [], 'pre-hook': []}, 'tags': [], 'description': '', 'columns': {'id': {'name': 'id', 'description': 'Auto-incrementing primary key', 'meta': {}, 'data_type': None, 'quote': None, 'tags': []}, 'name': {'name': 'name', 'description': 'Unique identifier for each record', 'meta': {}, 'data_type': None, 'quote': None, 'tags': []}, 'city': {'name': 'city', 'description': 'Name of the city', 'meta': {}, 'data_type': None, 'quote': None, 'tags': []}, 'region': {'name': 'region', 'description': 'Region of the city', 'meta': {}, 'data_type': None, 'quote': None, 'tags': []}, 'country': {'name': 'country', 'description': 'Country of the city', 'meta': {}, 'data_type': None, 'quote': None, 'tags': []}, 'lat': {'name': 'lat', 'description': 'Latitude of the city', 'meta': {}, 'data_type': None, 'quote': None, 'tags': []}, 'lon': {'name': 'lon', 'description': 'Longitude of the city', 'meta': {}, 'data_type': None, 'quote': None, 'tags': []}, 'tz_id': {'name': 'tz_id', 'description': 'Timezone ID of the city', 'meta': {}, 'data_type': None, 'quote': None, 'tags': []}, 'localtime_epoch': {'name': 'localtime_epoch', 'description': 'Epoch time of local time', 'meta': {}, 'data_type': None, 'quote': None, 'tags': []}, 'localtime': {'name': 'localtime', 'description': 'Local time of the city', 'meta': {}, 'data_type': None, 'quote': None, 'tags': []}}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': 'dbt_project://models/example/schema.yml', 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1718299805.755462, 'config_call_dict': {'materialized': 'table'}, 'relation_name': '"mydatabase"."public"."weather"', 'raw_code': "{{ config(\r\n    materialized='table'\r\n) }}\r\n\r\nselect *\r\nfrom {{ source('my_database', 'weather_data') }}", 'language': 'sql', 'refs': [], 'sources': [['my_database', 'weather_data']], 'metrics': [], 'depends_on': {'macros': [], 'nodes': ['source.dbt_project.my_database.weather_data']}, 'compiled_path': None}, 'test.dbt_project.unique_weather_id.c536a9e7ff': {'test_metadata': {'name': 'unique', 'kwargs': {'column_name': 'id', 'model': "{{ get_where_subquery(ref('weather')) }}"}, 'namespace': None}, 'database': 'mydatabase', 'schema': 'public_dbt_test__audit', 'name': 'unique_weather_id', 'resource_type': 'test', 'package_name': 'dbt_project', 'path': 'unique_weather_id.sql', 'original_file_path': 'models/example/schema.yml', 'unique_id': 'test.dbt_project.unique_weather_id.c536a9e7ff', 'fqn': ['dbt_project', 'example', 'unique_weather_id'], 'alias': 'unique_weather_id', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1718299805.771304, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_unique(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [['weather']], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_unique'], 'nodes': ['model.dbt_project.weather']}, 'compiled_path': None, 'column_name': 'id', 'file_key_name': 'models.weather'}, 'test.dbt_project.not_null_weather_id.058e194a5f': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': 'id', 'model': "{{ get_where_subquery(ref('weather')) }}"}, 'namespace': None}, 'database': 'mydatabase', 'schema': 'public_dbt_test__audit', 'name': 'not_null_weather_id', 'resource_type': 'test', 'package_name': 'dbt_project', 'path': 'not_null_weather_id.sql', 'original_file_path': 'models/example/schema.yml', 'unique_id': 'test.dbt_project.not_null_weather_id.058e194a5f', 'fqn': ['dbt_project', 'example', 'not_null_weather_id'], 'alias': 'not_null_weather_id', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1718299805.7734718, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [['weather']], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.dbt_project.weather']}, 'compiled_path': None, 'column_name': 'id', 'file_key_name': 'models.weather'}, 'test.dbt_project.not_null_weather_name.5470291197': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': 'name', 'model': "{{ get_where_subquery(ref('weather')) }}"}, 'namespace': None}, 'database': 'mydatabase', 'schema': 'public_dbt_test__audit', 'name': 'not_null_weather_name', 'resource_type': 'test', 'package_name': 'dbt_project', 'path': 'not_null_weather_name.sql', 'original_file_path': 'models/example/schema.yml', 'unique_id': 'test.dbt_project.not_null_weather_name.5470291197', 'fqn': ['dbt_project', 'example', 'not_null_weather_name'], 'alias': 'not_null_weather_name', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1718299805.7754774, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [['weather']], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.dbt_project.weather']}, 'compiled_path': None, 'column_name': 'name', 'file_key_name': 'models.weather'}, 'test.dbt_project.not_null_weather_city.1cb2e6334b': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': 'city', 'model': "{{ get_where_subquery(ref('weather')) }}"}, 'namespace': None}, 'database': 'mydatabase', 'schema': 'public_dbt_test__audit', 'name': 'not_null_weather_city', 'resource_type': 'test', 'package_name': 'dbt_project', 'path': 'not_null_weather_city.sql', 'original_file_path': 'models/example/schema.yml', 'unique_id': 'test.dbt_project.not_null_weather_city.1cb2e6334b', 'fqn': ['dbt_project', 'example', 'not_null_weather_city'], 'alias': 'not_null_weather_city', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1718299805.7776687, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [['weather']], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.dbt_project.weather']}, 'compiled_path': None, 'column_name': 'city', 'file_key_name': 'models.weather'}, 'test.dbt_project.not_null_weather_lat.8c99229d38': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': 'lat', 'model': "{{ get_where_subquery(ref('weather')) }}"}, 'namespace': None}, 'database': 'mydatabase', 'schema': 'public_dbt_test__audit', 'name': 'not_null_weather_lat', 'resource_type': 'test', 'package_name': 'dbt_project', 'path': 'not_null_weather_lat.sql', 'original_file_path': 'models/example/schema.yml', 'unique_id': 'test.dbt_project.not_null_weather_lat.8c99229d38', 'fqn': ['dbt_project', 'example', 'not_null_weather_lat'], 'alias': 'not_null_weather_lat', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1718299805.7797117, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [['weather']], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.dbt_project.weather']}, 'compiled_path': None, 'column_name': 'lat', 'file_key_name': 'models.weather'}, 'test.dbt_project.not_null_weather_lon.6d0547385c': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': 'lon', 'model': "{{ get_where_subquery(ref('weather')) }}"}, 'namespace': None}, 'database': 'mydatabase', 'schema': 'public_dbt_test__audit', 'name': 'not_null_weather_lon', 'resource_type': 'test', 'package_name': 'dbt_project', 'path': 'not_null_weather_lon.sql', 'original_file_path': 'models/example/schema.yml', 'unique_id': 'test.dbt_project.not_null_weather_lon.6d0547385c', 'fqn': ['dbt_project', 'example', 'not_null_weather_lon'], 'alias': 'not_null_weather_lon', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1718299805.7816458, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [['weather']], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.dbt_project.weather']}, 'compiled_path': None, 'column_name': 'lon', 'file_key_name': 'models.weather'}, 'test.dbt_project.not_null_weather_tz_id.4bb9fdc8b2': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': 'tz_id', 'model': "{{ get_where_subquery(ref('weather')) }}"}, 'namespace': None}, 'database': 'mydatabase', 'schema': 'public_dbt_test__audit', 'name': 'not_null_weather_tz_id', 'resource_type': 'test', 'package_name': 'dbt_project', 'path': 'not_null_weather_tz_id.sql', 'original_file_path': 'models/example/schema.yml', 'unique_id': 'test.dbt_project.not_null_weather_tz_id.4bb9fdc8b2', 'fqn': ['dbt_project', 'example', 'not_null_weather_tz_id'], 'alias': 'not_null_weather_tz_id', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1718299805.7835577, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [['weather']], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.dbt_project.weather']}, 'compiled_path': None, 'column_name': 'tz_id', 'file_key_name': 'models.weather'}, 'test.dbt_project.not_null_weather_localtime_epoch.1ba0604e09': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': 'localtime_epoch', 'model': "{{ get_where_subquery(ref('weather')) }}"}, 'namespace': None}, 'database': 'mydatabase', 'schema': 'public_dbt_test__audit', 'name': 'not_null_weather_localtime_epoch', 'resource_type': 'test', 'package_name': 'dbt_project', 'path': 'not_null_weather_localtime_epoch.sql', 'original_file_path': 'models/example/schema.yml', 'unique_id': 'test.dbt_project.not_null_weather_localtime_epoch.1ba0604e09', 'fqn': ['dbt_project', 'example', 'not_null_weather_localtime_epoch'], 'alias': 'not_null_weather_localtime_epoch', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1718299805.7854917, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [['weather']], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.dbt_project.weather']}, 'compiled_path': None, 'column_name': 'localtime_epoch', 'file_key_name': 'models.weather'}, 'test.dbt_project.not_null_weather_localtime.f06f4ed10b': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': 'localtime', 'model': "{{ get_where_subquery(ref('weather')) }}"}, 'namespace': None}, 'database': 'mydatabase', 'schema': 'public_dbt_test__audit', 'name': 'not_null_weather_localtime', 'resource_type': 'test', 'package_name': 'dbt_project', 'path': 'not_null_weather_localtime.sql', 'original_file_path': 'models/example/schema.yml', 'unique_id': 'test.dbt_project.not_null_weather_localtime.f06f4ed10b', 'fqn': ['dbt_project', 'example', 'not_null_weather_localtime'], 'alias': 'not_null_weather_localtime', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1718299805.7873607, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [['weather']], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.dbt_project.weather']}, 'compiled_path': None, 'column_name': 'localtime', 'file_key_name': 'models.weather'}}
[0m17:12:56.621622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ee62d93b-fd59-4abd-83ad-4bfd28ab8877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC3E5CCF70>]}
[0m17:12:57.783748 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:12:57.795975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ee62d93b-fd59-4abd-83ad-4bfd28ab8877', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC3F6171F0>]}
[0m17:12:58.053044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee62d93b-fd59-4abd-83ad-4bfd28ab8877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC4093B130>]}
[0m17:12:58.194139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee62d93b-fd59-4abd-83ad-4bfd28ab8877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC40958F10>]}
[0m17:12:58.194139 [info ] [MainThread]: Found 1 model, 9 data tests, 1 source, 413 macros
[0m17:12:58.194139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee62d93b-fd59-4abd-83ad-4bfd28ab8877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC408191F0>]}
[0m17:12:58.194139 [info ] [MainThread]: 
[0m17:12:58.194139 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:12:58.194139 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydatabase'
[0m17:12:59.481581 [debug] [ThreadPool]: Using postgres connection "list_mydatabase"
[0m17:12:59.481581 [debug] [ThreadPool]: On list_mydatabase: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase"} */

    select distinct nspname from pg_namespace
  
[0m17:12:59.481581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:59.506426 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:12:59.507969 [debug] [ThreadPool]: On list_mydatabase: Close
[0m17:12:59.509005 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydatabase_public'
[0m17:12:59.513067 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_public"
[0m17:12:59.513067 [debug] [ThreadPool]: On list_mydatabase_public: BEGIN
[0m17:12:59.513067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:59.537426 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:12:59.537950 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_public"
[0m17:12:59.538468 [debug] [ThreadPool]: On list_mydatabase_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase_public"} */
select
      'mydatabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'mydatabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'mydatabase' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:12:59.541076 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:12:59.542119 [debug] [ThreadPool]: On list_mydatabase_public: ROLLBACK
[0m17:12:59.542636 [debug] [ThreadPool]: On list_mydatabase_public: Close
[0m17:12:59.546289 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:59.546815 [debug] [MainThread]: On master: BEGIN
[0m17:12:59.547326 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:12:59.571314 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:12:59.571314 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:59.571836 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:12:59.574932 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m17:12:59.575957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee62d93b-fd59-4abd-83ad-4bfd28ab8877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC408AADF0>]}
[0m17:12:59.576478 [debug] [MainThread]: On master: ROLLBACK
[0m17:12:59.577502 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:59.577502 [debug] [MainThread]: On master: BEGIN
[0m17:12:59.579095 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:12:59.579095 [debug] [MainThread]: On master: COMMIT
[0m17:12:59.579617 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:59.580128 [debug] [MainThread]: On master: COMMIT
[0m17:12:59.580640 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:12:59.581167 [debug] [MainThread]: On master: Close
[0m17:12:59.581696 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:12:59.582218 [info ] [MainThread]: 
[0m17:12:59.585646 [debug] [Thread-1  ]: Began running node model.dbt_project.weather
[0m17:12:59.586160 [info ] [Thread-1  ]: 1 of 1 START sql table model public.weather .................................... [RUN]
[0m17:12:59.587198 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_project.weather'
[0m17:12:59.587717 [debug] [Thread-1  ]: Began compiling node model.dbt_project.weather
[0m17:12:59.593894 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.weather"
[0m17:12:59.594413 [debug] [Thread-1  ]: Began executing node model.dbt_project.weather
[0m17:12:59.625050 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.weather"
[0m17:12:59.625050 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.weather"
[0m17:12:59.625050 [debug] [Thread-1  ]: On model.dbt_project.weather: BEGIN
[0m17:12:59.625050 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:12:59.638587 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:12:59.638587 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.weather"
[0m17:12:59.639107 [debug] [Thread-1  ]: On model.dbt_project.weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.weather"} */

  
    

  create  table "mydatabase"."public"."weather__dbt_tmp"
  
  
    as
  
  (
    

select *
from "mydatabase"."public"."weather_data"
  );
  
[0m17:12:59.641208 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m17:12:59.645866 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.weather"
[0m17:12:59.646384 [debug] [Thread-1  ]: On model.dbt_project.weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.weather"} */
alter table "mydatabase"."public"."weather__dbt_tmp" rename to "weather"
[0m17:12:59.647425 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:12:59.656498 [debug] [Thread-1  ]: On model.dbt_project.weather: COMMIT
[0m17:12:59.656498 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.weather"
[0m17:12:59.656498 [debug] [Thread-1  ]: On model.dbt_project.weather: COMMIT
[0m17:12:59.662779 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:12:59.667374 [debug] [Thread-1  ]: Applying DROP to: "mydatabase"."public"."weather__dbt_backup"
[0m17:12:59.670437 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.weather"
[0m17:12:59.670944 [debug] [Thread-1  ]: On model.dbt_project.weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.weather"} */
drop table if exists "mydatabase"."public"."weather__dbt_backup" cascade
[0m17:12:59.672580 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m17:12:59.674102 [debug] [Thread-1  ]: On model.dbt_project.weather: Close
[0m17:12:59.675647 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee62d93b-fd59-4abd-83ad-4bfd28ab8877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC3F3B07C0>]}
[0m17:12:59.676168 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public.weather ............................... [[32mSELECT 2[0m in 0.09s]
[0m17:12:59.676689 [debug] [Thread-1  ]: Finished running node model.dbt_project.weather
[0m17:12:59.677728 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:59.678243 [debug] [MainThread]: On master: BEGIN
[0m17:12:59.678765 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:12:59.712164 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:12:59.712692 [debug] [MainThread]: On master: COMMIT
[0m17:12:59.712692 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:59.713216 [debug] [MainThread]: On master: COMMIT
[0m17:12:59.713742 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:12:59.714266 [debug] [MainThread]: On master: Close
[0m17:12:59.714777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:59.715288 [debug] [MainThread]: Connection 'list_mydatabase' was properly closed.
[0m17:12:59.715288 [debug] [MainThread]: Connection 'list_mydatabase_public' was properly closed.
[0m17:12:59.715807 [debug] [MainThread]: Connection 'model.dbt_project.weather' was properly closed.
[0m17:12:59.716326 [info ] [MainThread]: 
[0m17:12:59.716848 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.52 seconds (1.52s).
[0m17:12:59.717366 [debug] [MainThread]: Command end result
[0m17:12:59.734168 [info ] [MainThread]: 
[0m17:12:59.734168 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:12:59.734168 [info ] [MainThread]: 
[0m17:12:59.734168 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:12:59.734168 [debug] [MainThread]: Command `dbt run` succeeded at 17:12:59.734168 after 3.78 seconds
[0m17:12:59.734168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC3C4DBD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC407D6FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC3B257970>]}
[0m17:12:59.734168 [debug] [MainThread]: Flushing usage events


============================== 2024-06-17 18:14:50.209029 | e5e8b683-e575-440e-9d8e-b1cd29e83a79 ==============================
[0m18:14:50.209029 [info ] [MainThread]: Running with dbt=1.4.7
[0m18:14:50.211319 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:14:50.211819 [debug] [MainThread]: Tracking: tracking
[0m18:14:50.213766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11d2769360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11d27697e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11d27693c0>]}
[0m18:14:50.227261 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m18:14:50.256276 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:14:50.256998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e5e8b683-e575-440e-9d8e-b1cd29e83a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11d2925960>]}
[0m18:14:50.856395 [debug] [MainThread]: 1699: static parser successfully parsed example/weather.sql
[0m18:14:50.954830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5e8b683-e575-440e-9d8e-b1cd29e83a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11d0f73250>]}
[0m18:14:50.965858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5e8b683-e575-440e-9d8e-b1cd29e83a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11d291f550>]}
[0m18:14:50.966588 [info ] [MainThread]: Found 1 model, 9 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:14:50.967252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5e8b683-e575-440e-9d8e-b1cd29e83a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11d0e6ce20>]}
[0m18:14:50.968839 [info ] [MainThread]: 
[0m18:14:50.970825 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:14:50.972047 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydatabase'
[0m18:14:50.982731 [debug] [ThreadPool]: Using postgres connection "list_mydatabase"
[0m18:14:50.983323 [debug] [ThreadPool]: On list_mydatabase: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase"} */

    select distinct nspname from pg_namespace
  
[0m18:14:50.983862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:51.012439 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m18:14:51.014031 [debug] [ThreadPool]: On list_mydatabase: Close
[0m18:14:51.015693 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydatabase_public'
[0m18:14:51.021403 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_public"
[0m18:14:51.021857 [debug] [ThreadPool]: On list_mydatabase_public: BEGIN
[0m18:14:51.022284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:51.030270 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:14:51.030760 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_public"
[0m18:14:51.031200 [debug] [ThreadPool]: On list_mydatabase_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase_public"} */
select
      'mydatabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'mydatabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:14:51.034537 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m18:14:51.035842 [debug] [ThreadPool]: On list_mydatabase_public: ROLLBACK
[0m18:14:51.036994 [debug] [ThreadPool]: On list_mydatabase_public: Close
[0m18:14:51.043022 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:51.043598 [debug] [MainThread]: On master: BEGIN
[0m18:14:51.044180 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:14:51.052087 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:14:51.052628 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:51.053088 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:14:51.057681 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m18:14:51.058940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5e8b683-e575-440e-9d8e-b1cd29e83a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11d011b5b0>]}
[0m18:14:51.059866 [debug] [MainThread]: On master: ROLLBACK
[0m18:14:51.061129 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:51.061587 [debug] [MainThread]: On master: BEGIN
[0m18:14:51.063451 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:14:51.063932 [debug] [MainThread]: On master: COMMIT
[0m18:14:51.064419 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:51.064893 [debug] [MainThread]: On master: COMMIT
[0m18:14:51.066048 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:14:51.066522 [debug] [MainThread]: On master: Close
[0m18:14:51.067318 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:14:51.067935 [info ] [MainThread]: 
[0m18:14:51.082872 [debug] [Thread-1 (]: Began running node model.dbt_project.weather
[0m18:14:51.083541 [info ] [Thread-1 (]: 1 of 1 START sql table model public.weather .................................... [RUN]
[0m18:14:51.084440 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.weather'
[0m18:14:51.084919 [debug] [Thread-1 (]: Began compiling node model.dbt_project.weather
[0m18:14:51.087748 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.weather"
[0m18:14:51.092915 [debug] [Thread-1 (]: Timing info for model.dbt_project.weather (compile): 2024-06-17 18:14:51.085313 => 2024-06-17 18:14:51.092852
[0m18:14:51.093439 [debug] [Thread-1 (]: Began executing node model.dbt_project.weather
[0m18:14:51.127930 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.weather"
[0m18:14:51.132724 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m18:14:51.133154 [debug] [Thread-1 (]: On model.dbt_project.weather: BEGIN
[0m18:14:51.133564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:51.142589 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m18:14:51.143115 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m18:14:51.143570 [debug] [Thread-1 (]: On model.dbt_project.weather: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.weather"} */

  
    

  create  table "mydatabase"."public"."weather__dbt_tmp"
  as (
    

select *
from "mydatabase"."public"."weather_data"
  );
  
[0m18:14:51.146316 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0 seconds
[0m18:14:51.152513 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m18:14:51.153007 [debug] [Thread-1 (]: On model.dbt_project.weather: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.weather"} */
alter table "mydatabase"."public"."weather__dbt_tmp" rename to "weather"
[0m18:14:51.154833 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m18:14:51.172977 [debug] [Thread-1 (]: On model.dbt_project.weather: COMMIT
[0m18:14:51.173485 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m18:14:51.173913 [debug] [Thread-1 (]: On model.dbt_project.weather: COMMIT
[0m18:14:51.176049 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m18:14:51.180705 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m18:14:51.181207 [debug] [Thread-1 (]: On model.dbt_project.weather: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.weather"} */
drop table if exists "mydatabase"."public"."weather__dbt_backup" cascade
[0m18:14:51.183003 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m18:14:51.184331 [debug] [Thread-1 (]: Timing info for model.dbt_project.weather (execute): 2024-06-17 18:14:51.093903 => 2024-06-17 18:14:51.184281
[0m18:14:51.184779 [debug] [Thread-1 (]: On model.dbt_project.weather: Close
[0m18:14:51.185648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5e8b683-e575-440e-9d8e-b1cd29e83a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11d019eaa0>]}
[0m18:14:51.186301 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.weather ............................... [[32mSELECT 4[0m in 0.10s]
[0m18:14:51.188136 [debug] [Thread-1 (]: Finished running node model.dbt_project.weather
[0m18:14:51.189855 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:14:51.190369 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:51.190837 [debug] [MainThread]: On master: BEGIN
[0m18:14:51.191271 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:14:51.199353 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:14:51.199878 [debug] [MainThread]: On master: COMMIT
[0m18:14:51.200386 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:51.200852 [debug] [MainThread]: On master: COMMIT
[0m18:14:51.202011 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:14:51.202495 [debug] [MainThread]: On master: Close
[0m18:14:51.203267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:14:51.203747 [debug] [MainThread]: Connection 'list_mydatabase' was properly closed.
[0m18:14:51.204196 [debug] [MainThread]: Connection 'model.dbt_project.weather' was properly closed.
[0m18:14:51.205414 [info ] [MainThread]: 
[0m18:14:51.205984 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m18:14:51.206693 [debug] [MainThread]: Command end result
[0m18:14:51.217844 [info ] [MainThread]: 
[0m18:14:51.218545 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:14:51.219202 [info ] [MainThread]: 
[0m18:14:51.219897 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:14:51.220655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11d01dcc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11d01dd2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11d01de2c0>]}
[0m18:14:51.221221 [debug] [MainThread]: Flushing usage events


============================== 2024-06-24 13:43:38.553884 | 5147c416-8b09-4217-9afc-b60135631917 ==============================
[0m13:43:38.553884 [info ] [MainThread]: Running with dbt=1.4.7
[0m13:43:38.556229 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:43:38.556820 [debug] [MainThread]: Tracking: tracking
[0m13:43:38.558271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30530bd0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30530bd7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30530bd390>]}
[0m13:43:38.574297 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m13:43:38.654639 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:43:38.655303 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:43:38.661593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5147c416-8b09-4217-9afc-b60135631917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30517c6680>]}
[0m13:43:38.673090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5147c416-8b09-4217-9afc-b60135631917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f305191fca0>]}
[0m13:43:38.673900 [info ] [MainThread]: Found 1 model, 9 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:43:38.674535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5147c416-8b09-4217-9afc-b60135631917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f305191fd00>]}
[0m13:43:38.675965 [info ] [MainThread]: 
[0m13:43:38.678051 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:43:38.679305 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydatabase'
[0m13:43:38.689747 [debug] [ThreadPool]: Using postgres connection "list_mydatabase"
[0m13:43:38.690335 [debug] [ThreadPool]: On list_mydatabase: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase"} */

    select distinct nspname from pg_namespace
  
[0m13:43:38.690844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:38.704129 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m13:43:38.705763 [debug] [ThreadPool]: On list_mydatabase: Close
[0m13:43:38.707346 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mydatabase_public'
[0m13:43:38.713252 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_public"
[0m13:43:38.713948 [debug] [ThreadPool]: On list_mydatabase_public: BEGIN
[0m13:43:38.714569 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:38.723952 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:43:38.724853 [debug] [ThreadPool]: Using postgres connection "list_mydatabase_public"
[0m13:43:38.725360 [debug] [ThreadPool]: On list_mydatabase_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_mydatabase_public"} */
select
      'mydatabase' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'mydatabase' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:43:38.728739 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m13:43:38.730306 [debug] [ThreadPool]: On list_mydatabase_public: ROLLBACK
[0m13:43:38.731717 [debug] [ThreadPool]: On list_mydatabase_public: Close
[0m13:43:38.737848 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:38.738663 [debug] [MainThread]: On master: BEGIN
[0m13:43:38.739227 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:43:38.748234 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:43:38.749047 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:38.749515 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:43:38.753265 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m13:43:38.754637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5147c416-8b09-4217-9afc-b60135631917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f305180ec80>]}
[0m13:43:38.755385 [debug] [MainThread]: On master: ROLLBACK
[0m13:43:38.756874 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:38.757368 [debug] [MainThread]: On master: BEGIN
[0m13:43:38.759270 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:43:38.759740 [debug] [MainThread]: On master: COMMIT
[0m13:43:38.760162 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:38.760653 [debug] [MainThread]: On master: COMMIT
[0m13:43:38.762016 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:43:38.762559 [debug] [MainThread]: On master: Close
[0m13:43:38.763421 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:43:38.763987 [info ] [MainThread]: 
[0m13:43:38.776401 [debug] [Thread-1 (]: Began running node model.dbt_project.weather
[0m13:43:38.777174 [info ] [Thread-1 (]: 1 of 1 START sql table model public.weather .................................... [RUN]
[0m13:43:38.778195 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.weather'
[0m13:43:38.778722 [debug] [Thread-1 (]: Began compiling node model.dbt_project.weather
[0m13:43:38.781914 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.weather"
[0m13:43:38.786539 [debug] [Thread-1 (]: Timing info for model.dbt_project.weather (compile): 2024-06-24 13:43:38.779263 => 2024-06-24 13:43:38.786439
[0m13:43:38.787076 [debug] [Thread-1 (]: Began executing node model.dbt_project.weather
[0m13:43:38.823424 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.weather"
[0m13:43:38.828350 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m13:43:38.828911 [debug] [Thread-1 (]: On model.dbt_project.weather: BEGIN
[0m13:43:38.829357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:38.838543 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:43:38.839188 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m13:43:38.839596 [debug] [Thread-1 (]: On model.dbt_project.weather: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.weather"} */

  
    

  create  table "mydatabase"."public"."weather__dbt_tmp"
  as (
    

select *
from "mydatabase"."public"."weather_data"
  );
  
[0m13:43:38.841808 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0 seconds
[0m13:43:38.848910 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m13:43:38.849543 [debug] [Thread-1 (]: On model.dbt_project.weather: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.weather"} */
alter table "mydatabase"."public"."weather__dbt_tmp" rename to "weather"
[0m13:43:38.851206 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:43:38.870196 [debug] [Thread-1 (]: On model.dbt_project.weather: COMMIT
[0m13:43:38.871136 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m13:43:38.871602 [debug] [Thread-1 (]: On model.dbt_project.weather: COMMIT
[0m13:43:38.874263 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:43:38.880119 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.weather"
[0m13:43:38.880737 [debug] [Thread-1 (]: On model.dbt_project.weather: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.weather"} */
drop table if exists "mydatabase"."public"."weather__dbt_backup" cascade
[0m13:43:38.882233 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:43:38.883597 [debug] [Thread-1 (]: Timing info for model.dbt_project.weather (execute): 2024-06-24 13:43:38.787477 => 2024-06-24 13:43:38.883544
[0m13:43:38.884076 [debug] [Thread-1 (]: On model.dbt_project.weather: Close
[0m13:43:38.884905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5147c416-8b09-4217-9afc-b60135631917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3051673cd0>]}
[0m13:43:38.885532 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.weather ............................... [[32mSELECT 0[0m in 0.11s]
[0m13:43:38.887734 [debug] [Thread-1 (]: Finished running node model.dbt_project.weather
[0m13:43:38.889512 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:43:38.890007 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:38.890444 [debug] [MainThread]: On master: BEGIN
[0m13:43:38.890867 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:43:38.899366 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:43:38.899913 [debug] [MainThread]: On master: COMMIT
[0m13:43:38.900421 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:38.900877 [debug] [MainThread]: On master: COMMIT
[0m13:43:38.902249 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:43:38.902762 [debug] [MainThread]: On master: Close
[0m13:43:38.903604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:38.904370 [debug] [MainThread]: Connection 'model.dbt_project.weather' was properly closed.
[0m13:43:38.904871 [info ] [MainThread]: 
[0m13:43:38.905428 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m13:43:38.906094 [debug] [MainThread]: Command end result
[0m13:43:38.915942 [info ] [MainThread]: 
[0m13:43:38.916674 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:43:38.917307 [info ] [MainThread]: 
[0m13:43:38.917908 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:43:38.918679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3051673cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3051670100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f305165c160>]}
[0m13:43:38.919188 [debug] [MainThread]: Flushing usage events
